<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>nonlin: nonlin_core::fcnnvar_helper Type Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">nonlin
   &#160;<span id="projectnumber">1.3.0</span>
   </div>
   <div id="projectbrief">A library that provides routines to compute the solutions to systems of nonlinear equations.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="classes.html"><span>Data&#160;Types</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('structnonlin__core_1_1fcnnvar__helper.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="typenonlin__core_1_1fcnnvar__helper-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">nonlin_core::fcnnvar_helper Type Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Defines a type capable of encapsulating an equation of N variables.  
 <a href="structnonlin__core_1_1fcnnvar__helper.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac0e4eed2d730bce1c9d0814a1e444404"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1fcnnvar__helper.html#ac0e4eed2d730bce1c9d0814a1e444404">fcn</a> =&gt; fnh_fcn</td></tr>
<tr class="memdesc:ac0e4eed2d730bce1c9d0814a1e444404"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes the routine containing the function to evaluate.  <a href="#ac0e4eed2d730bce1c9d0814a1e444404">More...</a><br /></td></tr>
<tr class="separator:ac0e4eed2d730bce1c9d0814a1e444404"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b8deec62bcf7707e33e2d6d065e6bbe"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1fcnnvar__helper.html#a7b8deec62bcf7707e33e2d6d065e6bbe">is_fcn_defined</a> =&gt; fnh_is_fcn_defined</td></tr>
<tr class="memdesc:a7b8deec62bcf7707e33e2d6d065e6bbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests if the pointer to the function has been assigned.  <a href="#a7b8deec62bcf7707e33e2d6d065e6bbe">More...</a><br /></td></tr>
<tr class="separator:a7b8deec62bcf7707e33e2d6d065e6bbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc9a43e847b8114d2004ba0873858924"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1fcnnvar__helper.html#acc9a43e847b8114d2004ba0873858924">set_fcn</a> =&gt; fnh_set_fcn</td></tr>
<tr class="memdesc:acc9a43e847b8114d2004ba0873858924"><td class="mdescLeft">&#160;</td><td class="mdescRight">Establishes a pointer to the routine containing the function.  <a href="#acc9a43e847b8114d2004ba0873858924">More...</a><br /></td></tr>
<tr class="separator:acc9a43e847b8114d2004ba0873858924"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade676773e3157767d65f64f21f8aa090"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1fcnnvar__helper.html#ade676773e3157767d65f64f21f8aa090">get_variable_count</a> =&gt; fnh_get_nvar</td></tr>
<tr class="memdesc:ade676773e3157767d65f64f21f8aa090"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the number of variables in this system.  <a href="#ade676773e3157767d65f64f21f8aa090">More...</a><br /></td></tr>
<tr class="separator:ade676773e3157767d65f64f21f8aa090"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3eea5d29dd8aa70e76173fc0f30e022"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1fcnnvar__helper.html#ac3eea5d29dd8aa70e76173fc0f30e022">set_gradient_fcn</a> =&gt; fnh_set_grad</td></tr>
<tr class="memdesc:ac3eea5d29dd8aa70e76173fc0f30e022"><td class="mdescLeft">&#160;</td><td class="mdescRight">Establishes a pointer to the routine containing the gradient vector of the function.  <a href="#ac3eea5d29dd8aa70e76173fc0f30e022">More...</a><br /></td></tr>
<tr class="separator:ac3eea5d29dd8aa70e76173fc0f30e022"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b884a36ba2b9c15c9b325fb08d7597f"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1fcnnvar__helper.html#a8b884a36ba2b9c15c9b325fb08d7597f">is_gradient_defined</a> =&gt; fnh_is_grad_defined</td></tr>
<tr class="memdesc:a8b884a36ba2b9c15c9b325fb08d7597f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests if the pointer to the routine containing the gradient has been assigned.  <a href="#a8b884a36ba2b9c15c9b325fb08d7597f">More...</a><br /></td></tr>
<tr class="separator:a8b884a36ba2b9c15c9b325fb08d7597f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94732556188c1ac5a2cfc6d6e9e06cf2"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1fcnnvar__helper.html#a94732556188c1ac5a2cfc6d6e9e06cf2">gradient</a> =&gt; fnh_grad_fcn</td></tr>
<tr class="memdesc:a94732556188c1ac5a2cfc6d6e9e06cf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the gradient of the function.  <a href="#a94732556188c1ac5a2cfc6d6e9e06cf2">More...</a><br /></td></tr>
<tr class="separator:a94732556188c1ac5a2cfc6d6e9e06cf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a08e6e6f24db4d2f971aae68cfa7fc031"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a08e6e6f24db4d2f971aae68cfa7fc031"></a>
procedure(<a class="el" href="interfacenonlin__core_1_1fcnnvar.html">fcnnvar</a>), pointer, nopass&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1fcnnvar__helper.html#a08e6e6f24db4d2f971aae68cfa7fc031">m_fcn</a> =&gt; null()</td></tr>
<tr class="memdesc:a08e6e6f24db4d2f971aae68cfa7fc031"><td class="mdescLeft">&#160;</td><td class="mdescRight">A pointer to the target fcnnvar routine. <br /></td></tr>
<tr class="separator:a08e6e6f24db4d2f971aae68cfa7fc031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad15fb7b435bd7393fb4fb490485d84e1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad15fb7b435bd7393fb4fb490485d84e1"></a>
procedure(<a class="el" href="interfacenonlin__core_1_1gradientfcn.html">gradientfcn</a>), pointer, nopass&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1fcnnvar__helper.html#ad15fb7b435bd7393fb4fb490485d84e1">m_grad</a> =&gt; null()</td></tr>
<tr class="memdesc:ad15fb7b435bd7393fb4fb490485d84e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">A pointer to the gradient routine. <br /></td></tr>
<tr class="separator:ad15fb7b435bd7393fb4fb490485d84e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18683497b25cf991e39104b4d8ac0d3e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a18683497b25cf991e39104b4d8ac0d3e"></a>
integer(int32)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1fcnnvar__helper.html#a18683497b25cf991e39104b4d8ac0d3e">m_nvar</a> = 0</td></tr>
<tr class="memdesc:a18683497b25cf991e39104b4d8ac0d3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of variables in m_fcn. <br /></td></tr>
<tr class="separator:a18683497b25cf991e39104b4d8ac0d3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Defines a type capable of encapsulating an equation of N variables. </p>
<dl class="section user"><dt>Example</dt><dd>The following example illustrates how to use this type to find the minimum of a function of multiple variables. In this instance the Nelder-Mead simplex method is utilized to minimize the Rosenbrock function in two variables. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span>iso_fortran_env</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__optimize.html">nonlin_optimize</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__core.html">nonlin_core</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Local Variables</span></div><div class="line">    <span class="keywordtype">type</span>(<a class="code" href="structnonlin__optimize_1_1nelder__mead.html">nelder_mead</a>) :: solver</div><div class="line">    <span class="keywordtype">type</span>(<a class="code" href="structnonlin__core_1_1fcnnvar__helper.html">fcnnvar_helper</a>) :: obj</div><div class="line">    <span class="keywordtype">procedure</span>(<a class="code" href="interfacenonlin__core_1_1fcnnvar.html">fcnnvar</a>), <span class="keywordtype">pointer</span> :: fcn</div><div class="line">    <span class="keywordtype">real(real64)</span> :: x(2), f</div><div class="line"></div><div class="line">    <span class="comment">! Initialization</span></div><div class="line">    fcn =&gt; rosenbrock</div><div class="line">    <span class="keyword">call </span>obj%set_fcn(fcn, 2)</div><div class="line"></div><div class="line">    <span class="comment">! Define an initial guess - the solution is (1, 1)</span></div><div class="line">    <span class="keyword">call </span>random_number(x)</div><div class="line"></div><div class="line">    <span class="comment">! Call the solver</span></div><div class="line">    <span class="keyword">call </span>solver%solve(obj, x, f)</div><div class="line"></div><div class="line">     <span class="comment">! Display the output</span></div><div class="line">     print <span class="stringliteral">&#39;(AF7.5AF7.5A)&#39;</span>, <span class="stringliteral">&quot;Minimum: (&quot;</span>, x(1), <span class="stringliteral">&quot;, &quot;</span>, x(2), <span class="stringliteral">&quot;)&quot;</span></div><div class="line">     print <span class="stringliteral">&#39;(AE9.3)&#39;</span>, <span class="stringliteral">&quot;Function Value: &quot;</span>, f</div><div class="line"><span class="keyword">contains</span></div><div class="line">    <span class="comment">! Rosenbrock&#39;s Function</span></div><div class="line"><span class="keyword">    function </span>rosenbrock(x) result(f)</div><div class="line">        <span class="keywordtype">real(real64)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x</div><div class="line">        <span class="keywordtype">real(real64)</span> :: f</div><div class="line">        f = 1.0d2 * (x(2) - x(1)**2)**2 + (x(1) - 1.0d0)**2</div><div class="line"><span class="keyword">    end function</span></div><div class="line"><span class="keyword">end program</span></div></div><!-- fragment --> The above program produces the following output. <div class="fragment"><div class="line">Minimum: (1.00000, 1.00000)</div><div class="line">Function Value: 0.213E-12</div></div><!-- fragment --> </dd></dl>

<p>Definition at line <a class="el" href="nonlin__core_8f90_source.html#l00701">701</a> of file <a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a>.</p>
</div><h2 class="groupheader">Member Function/Subroutine Documentation</h2>
<a class="anchor" id="ac0e4eed2d730bce1c9d0814a1e444404"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_core::fcnnvar_helper::fcn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Executes the routine containing the function to evaluate. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">real(real64) </span><span class="keyword">function </span>fcn(class(fcnnvar_helper) this, real(real64) x(:))</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__core_1_1fcnnvar__helper.html" title="Defines a type capable of encapsulating an equation of N variables. ">fcnnvar_helper</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The value of the independent variable at which the function should be evaluated. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The value of the function at <code>x</code>. </dd></dl>

<p>Definition at line <a class="el" href="nonlin__core_8f90_source.html#l00721">721</a> of file <a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a>.</p>

</div>
</div>
<a class="anchor" id="ade676773e3157767d65f64f21f8aa090"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_core::fcnnvar_helper::get_variable_count </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the number of variables in this system. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">pure integer(int32) </span><span class="keyword">function </span>get_variable_count(class(fcnnvar_helper) this)</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__core_1_1fcnnvar__helper.html" title="Defines a type capable of encapsulating an equation of N variables. ">fcnnvar_helper</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of variables. </dd></dl>

<p>Definition at line <a class="el" href="nonlin__core_8f90_source.html#l00798">798</a> of file <a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a>.</p>

</div>
</div>
<a class="anchor" id="a94732556188c1ac5a2cfc6d6e9e06cf2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_core::fcnnvar_helper::gradient </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the gradient of the function. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">subroutine </span>gradient(class(fcnnvar_helper) this, real(real64) x(:), &amp;</div><div class="line"> <span class="keywordtype">real(real64)</span> g(:), <span class="keywordtype">optional</span> <span class="keywordtype">real(real64)</span> fv(:), &amp;</div><div class="line"> <span class="keywordtype">optional</span> <span class="keywordtype">integer(int32)</span> err)</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__core_1_1fcnnvar__helper.html" title="Defines a type capable of encapsulating an equation of N variables. ">fcnnvar_helper</a> object. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>An N-element array containing the independent variables defining the point about which the derivatives will be calculated. This array is restored upon output. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">g</td><td>An N-element array where the gradient will be written upon output. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fv</td><td>An optional input providing the function value at <code>x</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional integer output that can be used to determine error status. If not used, and an error is encountered, the routine simply returns silently. If used, the following error codes identify error status:<ul>
<li>0: No error has occurred.</li>
<li>n: A positive integer denoting the index of an invalid input. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="nonlin__core_8f90_source.html#l00909">909</a> of file <a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a>.</p>

</div>
</div>
<a class="anchor" id="a7b8deec62bcf7707e33e2d6d065e6bbe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_core::fcnnvar_helper::is_fcn_defined </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests if the pointer to the function has been assigned. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">pure logical </span><span class="keyword">function </span>is_fcn_defined(class(fcnnvar_helper) this)</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__core_1_1fcnnvar__helper.html" title="Defines a type capable of encapsulating an equation of N variables. ">fcnnvar_helper</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the pointer has been assigned; else, false. </dd></dl>

<p>Definition at line <a class="el" href="nonlin__core_8f90_source.html#l00731">731</a> of file <a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a>.</p>

</div>
</div>
<a class="anchor" id="a8b884a36ba2b9c15c9b325fb08d7597f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_core::fcnnvar_helper::is_gradient_defined </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests if the pointer to the routine containing the gradient has been assigned. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">pure logical </span><span class="keyword">function </span>is_gradient_defined(class(fcnnvar_helper) this)</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__core_1_1fcnnvar__helper.html" title="Defines a type capable of encapsulating an equation of N variables. ">fcnnvar_helper</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the pointer has been assigned; else, false. </dd></dl>

<p>Definition at line <a class="el" href="nonlin__core_8f90_source.html#l00886">886</a> of file <a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a>.</p>

</div>
</div>
<a class="anchor" id="acc9a43e847b8114d2004ba0873858924"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_core::fcnnvar_helper::set_fcn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Establishes a pointer to the routine containing the function. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">subroutine </span>set_fcn(class(fcnnvar_helper) this, procedure(fcnnvar) pointer fcn, integer(int32) nvar)</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__core_1_1fcnnvar__helper.html" title="Defines a type capable of encapsulating an equation of N variables. ">fcnnvar_helper</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fcn</td><td>The function pointer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nvar</td><td>The number of variables in the function.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Example</dt><dd>The following example illustrates how to use this routine to inform the solver of the function to optimize. This particular example utilizes the Nelder-Mead simplex method to minimize the function. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span>iso_fortran_env</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__optimize.html">nonlin_optimize</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__core.html">nonlin_core</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Local Variables</span></div><div class="line">    <span class="keywordtype">type</span>(<a class="code" href="structnonlin__optimize_1_1nelder__mead.html">nelder_mead</a>) :: solver</div><div class="line">    <span class="keywordtype">type</span>(<a class="code" href="structnonlin__core_1_1fcnnvar__helper.html">fcnnvar_helper</a>) :: obj</div><div class="line">    <span class="keywordtype">procedure</span>(<a class="code" href="interfacenonlin__core_1_1fcnnvar.html">fcnnvar</a>), <span class="keywordtype">pointer</span> :: fcn</div><div class="line">    <span class="keywordtype">real(real64)</span> :: x(2), f</div><div class="line"></div><div class="line">    <span class="comment">! Initialization</span></div><div class="line">    fcn =&gt; rosenbrock</div><div class="line">    <span class="keyword">call </span>obj%set_fcn(fcn, 2)</div><div class="line"></div><div class="line">    <span class="comment">! Define an initial guess - the solution is (1, 1)</span></div><div class="line">    <span class="keyword">call </span>random_number(x)</div><div class="line"></div><div class="line">    <span class="comment">! Call the solver</span></div><div class="line">    <span class="keyword">call </span>solver%solve(obj, x, f)</div><div class="line"></div><div class="line">     <span class="comment">! Display the output</span></div><div class="line">     print <span class="stringliteral">&#39;(AF7.5AF7.5A)&#39;</span>, <span class="stringliteral">&quot;Minimum: (&quot;</span>, x(1), <span class="stringliteral">&quot;, &quot;</span>, x(2), <span class="stringliteral">&quot;)&quot;</span></div><div class="line">     print <span class="stringliteral">&#39;(AE9.3)&#39;</span>, <span class="stringliteral">&quot;Function Value: &quot;</span>, f</div><div class="line"><span class="keyword">contains</span></div><div class="line">    <span class="comment">! Rosenbrock&#39;s Function</span></div><div class="line"><span class="keyword">    function </span>rosenbrock(x) result(f)</div><div class="line">        <span class="keywordtype">real(real64)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x</div><div class="line">        <span class="keywordtype">real(real64)</span> :: f</div><div class="line">        f = 1.0d2 * (x(2) - x(1)**2)**2 + (x(1) - 1.0d0)**2</div><div class="line"><span class="keyword">    end function</span></div><div class="line"><span class="keyword">end program</span></div></div><!-- fragment --> The above program produces the following output. <div class="fragment"><div class="line">Minimum: (1.00000, 1.00000)</div><div class="line">Function Value: 0.213E-12</div></div><!-- fragment --> </dd></dl>

<p>Definition at line <a class="el" href="nonlin__core_8f90_source.html#l00788">788</a> of file <a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a>.</p>

</div>
</div>
<a class="anchor" id="ac3eea5d29dd8aa70e76173fc0f30e022"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_core::fcnnvar_helper::set_gradient_fcn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Establishes a pointer to the routine containing the gradient vector of the function. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">subroutine </span>set_gradient_fcn(class(fcnnvar_helper) this, procedure(gradientfcn) pointer fcn)</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__core_1_1fcnnvar__helper.html" title="Defines a type capable of encapsulating an equation of N variables. ">fcnnvar_helper</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fcn</td><td>The pointer to the gradient routine.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Example</dt><dd>The following example illustrates the use of a user-defined gradient function. This particular example utilizes the BFGS method to minimize Beale's function. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span>iso_fortran_env</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__core.html">nonlin_core</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__optimize.html">nonlin_optimize</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Local Variables</span></div><div class="line">    <span class="keywordtype">type</span>(<a class="code" href="structnonlin__optimize_1_1bfgs.html">bfgs</a>) :: solver</div><div class="line">    <span class="keywordtype">type</span>(<a class="code" href="structnonlin__core_1_1fcnnvar__helper.html">fcnnvar_helper</a>) :: obj</div><div class="line">    <span class="keywordtype">procedure</span>(<a class="code" href="interfacenonlin__core_1_1fcnnvar.html">fcnnvar</a>), <span class="keywordtype">pointer</span> :: fcn</div><div class="line">    <span class="keywordtype">procedure</span>(<a class="code" href="interfacenonlin__core_1_1gradientfcn.html">gradientfcn</a>), <span class="keywordtype">pointer</span> :: grad</div><div class="line">    <span class="keywordtype">real(real64)</span> :: x(2), f</div><div class="line"></div><div class="line">    <span class="comment">! Tell the solver where to find the function</span></div><div class="line">    fcn =&gt; beale</div><div class="line">    grad =&gt; bealegrad</div><div class="line">    <span class="keyword">call </span>obj%set_fcn(fcn, 2)</div><div class="line">    <span class="keyword">call </span>obj%set_gradient_fcn(grad)</div><div class="line"></div><div class="line">    <span class="comment">! Define an initial guess</span></div><div class="line">    x = 1.0d0</div><div class="line"></div><div class="line">    <span class="comment">! Compute the solution</span></div><div class="line">    <span class="keyword">call </span>solver%solve(obj, x, f)</div><div class="line"></div><div class="line">    <span class="comment">! Display the output</span></div><div class="line">    print <span class="stringliteral">&#39;(AF7.5AF7.5A)&#39;</span>, <span class="stringliteral">&quot;Minimum: (&quot;</span>, x(1), <span class="stringliteral">&quot;, &quot;</span>, x(2), <span class="stringliteral">&quot;)&quot;</span></div><div class="line">    print <span class="stringliteral">&#39;(AE9.3)&#39;</span>, <span class="stringliteral">&quot;Function Value: &quot;</span>, f</div><div class="line"><span class="keyword">contains</span></div><div class="line">    <span class="comment">! The Beale function:</span></div><div class="line">    <span class="comment">! f(x) = (1.5 - x + xy)**2 + (2.25 - x + xy**2)**2 + (2.625 - x + xy**3)**2</span></div><div class="line">    <span class="comment">! The minimum is at x = 3, y = 0.5, and f(3, 0.5) = 0</span></div><div class="line"><span class="keyword">    function </span>beale(x) result(f)</div><div class="line">        <span class="keywordtype">real(real64)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x</div><div class="line">        <span class="keywordtype">real(real64)</span> :: f</div><div class="line">        f = (1.5d0 - x(1) + x(1) * x(2))**2 + &amp;</div><div class="line">            (2.25d0 - x(1) + x(1) * x(2)**2)**2 + &amp;</div><div class="line">            (2.625d0 - x(1) + x(1) * x(2)**3)**2</div><div class="line"><span class="keyword">    end function</span></div><div class="line"></div><div class="line">    <span class="comment">! The gradient</span></div><div class="line"><span class="keyword">    subroutine </span>bealegrad(x, g)</div><div class="line">        <span class="keywordtype">real(real64)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x</div><div class="line">        <span class="keywordtype">real(real64)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:)</span> :: g</div><div class="line"></div><div class="line">        g(1) = 2.0d0 * (x(2)**3 - 1.0d0) * (x(1) * x(2)**3 - x(1) + 2.625d0) + &amp;</div><div class="line">            2.0d0 * (x(2)**2 - 1.0d0) * (x(1) * x(2)**2 - x(1) + 2.25d0) + &amp;</div><div class="line">            2.0d0 * (x(2) - 1.0d0) * (x(1) * x(2) - x(1) + 1.5d0)</div><div class="line"></div><div class="line">        g(2) = 6.0d0 * x(1) * x(2)**2 * (x(1) * x(2)**3 - x(1) + 2.625d0) + &amp;</div><div class="line">            4.0d0 * x(1) * x(2) * (x(1) * x(2)**2 - x(1) + 2.25d0) + &amp;</div><div class="line">            2.0d0 * x(1) * (x(1) * x(2) - x(1) + 1.5d0)</div><div class="line"><span class="keyword">    end subroutine</span></div><div class="line"><span class="keyword">end program</span></div></div><!-- fragment --> The above program produces the following output. <div class="fragment"><div class="line">Minimum: (3.00000, 0.50000)</div><div class="line">Function Value: 0.999E-28</div></div><!-- fragment --> </dd></dl>

<p>Definition at line <a class="el" href="nonlin__core_8f90_source.html#l00875">875</a> of file <a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a>.</p>

</div>
</div>
<hr/>The documentation for this type was generated from the following file:<ul>
<li>D:/users/christopherson/Code/nonlin/src/<a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacenonlin__core.html">nonlin_core</a></li><li class="navelem"><a class="el" href="structnonlin__core_1_1fcnnvar__helper.html">fcnnvar_helper</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
