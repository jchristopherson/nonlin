<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>nonlin: nonlin_optimize::nelder_mead Type Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">nonlin
   &#160;<span id="projectnumber">1.3.0</span>
   </div>
   <div id="projectbrief">A library that provides routines to compute the solutions to systems of nonlinear equations.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('structnonlin__optimize_1_1nelder__mead.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="structnonlin__optimize_1_1nelder__mead-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">nonlin_optimize::nelder_mead Type Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Defines a solver based upon Nelder and Mead's simplex algorithm for minimization of functions of multiple variables.  
 <a href="structnonlin__optimize_1_1nelder__mead.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for nonlin_optimize::nelder_mead:</div>
<div class="dyncontent">
 <div class="center">
  <img src="structnonlin__optimize_1_1nelder__mead.png" usemap="#nonlin_5Foptimize::nelder_5Fmead_map" alt=""/>
  <map id="nonlin_5Foptimize::nelder_5Fmead_map" name="nonlin_5Foptimize::nelder_5Fmead_map">
<area href="structnonlin__core_1_1equation__optimizer.html" title="A base class for optimization of an equation of multiple variables. " alt="nonlin_core::equation_optimizer" shape="rect" coords="0,0,189,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1cc60f4f3daecc2f314fd02ab05854c6"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__optimize_1_1nelder__mead.html#a1cc60f4f3daecc2f314fd02ab05854c6">solve</a> =&gt; nm_solve</td></tr>
<tr class="memdesc:a1cc60f4f3daecc2f314fd02ab05854c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utilizes the Nelder-Mead simplex method for finding a minimum value of the specified function.  <a href="#a1cc60f4f3daecc2f314fd02ab05854c6">More...</a><br /></td></tr>
<tr class="separator:a1cc60f4f3daecc2f314fd02ab05854c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af262957b196243601501c8540ed6edf2"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__optimize_1_1nelder__mead.html#af262957b196243601501c8540ed6edf2">get_simplex</a> =&gt; nm_get_simplex</td></tr>
<tr class="memdesc:af262957b196243601501c8540ed6edf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets an N-by-(N+1) matrix containing the current simplex.  <a href="#af262957b196243601501c8540ed6edf2">More...</a><br /></td></tr>
<tr class="separator:af262957b196243601501c8540ed6edf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af135618858e807fc51ebd6063ac9c736"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__optimize_1_1nelder__mead.html#af135618858e807fc51ebd6063ac9c736">set_simplex</a> =&gt; nm_set_simplex</td></tr>
<tr class="memdesc:af135618858e807fc51ebd6063ac9c736"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets an N-by-(N+1) matrix as the current simplex. Notice, if this matrix is different in size from the problem dimensionallity, the Nelder-Mead routine will replace it with an appropriately sized matrix.  <a href="#af135618858e807fc51ebd6063ac9c736">More...</a><br /></td></tr>
<tr class="separator:af135618858e807fc51ebd6063ac9c736"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09b33f9ff6f17e1cc0d56befa1a77b4"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__optimize_1_1nelder__mead.html#ad09b33f9ff6f17e1cc0d56befa1a77b4">get_initial_size</a> =&gt; nm_get_size</td></tr>
<tr class="memdesc:ad09b33f9ff6f17e1cc0d56befa1a77b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the size of the initial simplex that will be utilized by the Nelder-Mead algorithm in the event that the user does not supply a simplex geometry, or if the user supplies an invalid simplex geometry.  <a href="#ad09b33f9ff6f17e1cc0d56befa1a77b4">More...</a><br /></td></tr>
<tr class="separator:ad09b33f9ff6f17e1cc0d56befa1a77b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a7e271e79bbf0249dc2a64fd2f46a46"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__optimize_1_1nelder__mead.html#a7a7e271e79bbf0249dc2a64fd2f46a46">set_initial_size</a> =&gt; nm_set_size</td></tr>
<tr class="memdesc:a7a7e271e79bbf0249dc2a64fd2f46a46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the size of the initial simplex that will be utilized by the Nelder-Mead algorithm in the event that the user does not supply a simplex geometry, or if the user supplies an invalid simplex geometry.  <a href="#a7a7e271e79bbf0249dc2a64fd2f46a46">More...</a><br /></td></tr>
<tr class="separator:a7a7e271e79bbf0249dc2a64fd2f46a46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_structnonlin__core_1_1equation__optimizer"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_structnonlin__core_1_1equation__optimizer')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="structnonlin__core_1_1equation__optimizer.html">nonlin_core::equation_optimizer</a></td></tr>
<tr class="memitem:ace21c015ea34abffb4422ca1f5a7cf3b inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__optimizer.html#ace21c015ea34abffb4422ca1f5a7cf3b">get_max_fcn_evals</a> =&gt; oe_get_max_eval</td></tr>
<tr class="memdesc:ace21c015ea34abffb4422ca1f5a7cf3b inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the maximum number of function evaluations allowed.  <a href="structnonlin__core_1_1equation__optimizer.html#ace21c015ea34abffb4422ca1f5a7cf3b">More...</a><br /></td></tr>
<tr class="separator:ace21c015ea34abffb4422ca1f5a7cf3b inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c551cb42fa08ea1921169676d22591c inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__optimizer.html#a6c551cb42fa08ea1921169676d22591c">set_max_fcn_evals</a> =&gt; oe_set_max_eval</td></tr>
<tr class="memdesc:a6c551cb42fa08ea1921169676d22591c inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the maximum number of function evaluations allowed.  <a href="structnonlin__core_1_1equation__optimizer.html#a6c551cb42fa08ea1921169676d22591c">More...</a><br /></td></tr>
<tr class="separator:a6c551cb42fa08ea1921169676d22591c inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf732e2442a2671c22a277cb433195d1 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__optimizer.html#abf732e2442a2671c22a277cb433195d1">get_tolerance</a> =&gt; oe_get_tol</td></tr>
<tr class="memdesc:abf732e2442a2671c22a277cb433195d1 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the tolerance on convergence.  <a href="structnonlin__core_1_1equation__optimizer.html#abf732e2442a2671c22a277cb433195d1">More...</a><br /></td></tr>
<tr class="separator:abf732e2442a2671c22a277cb433195d1 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b2c2a096683a7758a487194a8d35868 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__optimizer.html#a7b2c2a096683a7758a487194a8d35868">set_tolerance</a> =&gt; oe_set_tol</td></tr>
<tr class="memdesc:a7b2c2a096683a7758a487194a8d35868 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the tolerance on convergence.  <a href="structnonlin__core_1_1equation__optimizer.html#a7b2c2a096683a7758a487194a8d35868">More...</a><br /></td></tr>
<tr class="separator:a7b2c2a096683a7758a487194a8d35868 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63fdb11e6eb358cace29507f7e112485 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__optimizer.html#a63fdb11e6eb358cace29507f7e112485">get_print_status</a> =&gt; oe_get_print_status</td></tr>
<tr class="memdesc:a63fdb11e6eb358cace29507f7e112485 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a logical value determining if iteration status should be printed.  <a href="structnonlin__core_1_1equation__optimizer.html#a63fdb11e6eb358cace29507f7e112485">More...</a><br /></td></tr>
<tr class="separator:a63fdb11e6eb358cace29507f7e112485 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbad8ebeefbd80e0e1d0d4d4701f7ae5 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__optimizer.html#acbad8ebeefbd80e0e1d0d4d4701f7ae5">set_print_status</a> =&gt; oe_set_print_status</td></tr>
<tr class="memdesc:acbad8ebeefbd80e0e1d0d4d4701f7ae5 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets a logical value determining if iteration status should be printed.  <a href="structnonlin__core_1_1equation__optimizer.html#acbad8ebeefbd80e0e1d0d4d4701f7ae5">More...</a><br /></td></tr>
<tr class="separator:acbad8ebeefbd80e0e1d0d4d4701f7ae5 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09e6312fb045d465a9baffd534500917 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memItemLeft" align="right" valign="top">procedure(<a class="el" href="interfacenonlin__core_1_1nonlin__optimize__fcn.html">nonlin_optimize_fcn</a>), deferred, pass, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__optimizer.html#a09e6312fb045d465a9baffd534500917">solve</a></td></tr>
<tr class="memdesc:a09e6312fb045d465a9baffd534500917 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Optimizes the equation.  <a href="structnonlin__core_1_1equation__optimizer.html#a09e6312fb045d465a9baffd534500917">More...</a><br /></td></tr>
<tr class="separator:a09e6312fb045d465a9baffd534500917 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a4f23b7fdeadd1789895d385d3646d2a7"><td class="memItemLeft" align="right" valign="top">procedure, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__optimize_1_1nelder__mead.html#a4f23b7fdeadd1789895d385d3646d2a7">extrapolate</a> =&gt; nm_extrapolate</td></tr>
<tr class="memdesc:a4f23b7fdeadd1789895d385d3646d2a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates by the specified factor through the simplex across from the largest point. If the extrapolation results in a better estimate, the current high point is replaced with the new estimate.  <a href="#a4f23b7fdeadd1789895d385d3646d2a7">More...</a><br /></td></tr>
<tr class="separator:a4f23b7fdeadd1789895d385d3646d2a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:af5d3d067795864bdd038f794a08231f2"><td class="memItemLeft" align="right" valign="top"><a id="af5d3d067795864bdd038f794a08231f2"></a>
real(real64), dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__optimize_1_1nelder__mead.html#af5d3d067795864bdd038f794a08231f2">m_simplex</a></td></tr>
<tr class="memdesc:af5d3d067795864bdd038f794a08231f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The simplex vertices. <br /></td></tr>
<tr class="separator:af5d3d067795864bdd038f794a08231f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa05ef531dcb5279fcc00f66ddaa36555"><td class="memItemLeft" align="right" valign="top"><a id="aa05ef531dcb5279fcc00f66ddaa36555"></a>
real(real64)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__optimize_1_1nelder__mead.html#aa05ef531dcb5279fcc00f66ddaa36555">m_initsize</a> = 1.0d0</td></tr>
<tr class="memdesc:aa05ef531dcb5279fcc00f66ddaa36555"><td class="mdescLeft">&#160;</td><td class="mdescRight">A scaling parameter used to define the size of the simplex in each coordinate direction. <br /></td></tr>
<tr class="separator:aa05ef531dcb5279fcc00f66ddaa36555"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Defines a solver based upon Nelder and Mead's simplex algorithm for minimization of functions of multiple variables. </p>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00033">33</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>
</div><h2 class="groupheader">Member Function/Subroutine Documentation</h2>
<a id="a4f23b7fdeadd1789895d385d3646d2a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f23b7fdeadd1789895d385d3646d2a7">&#9670;&nbsp;</a></span>extrapolate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">procedure, private nonlin_optimize::nelder_mead::extrapolate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extrapolates by the specified factor through the simplex across from the largest point. If the extrapolation results in a better estimate, the current high point is replaced with the new estimate. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">real(real64) </span><span class="keyword">function </span>extrapolate(class(nelder_mead) this, class(fcnnvar_helper) fcn, real(real64) y(:), real(real64) pcent(:), integer(int32) ihi, real(real64) fac, integer(int32) neval, real(real64) work(:))</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1nelder__mead.html" title="Defines a solver based upon Nelder and Mead&#39;s simplex algorithm for minimization of functions of mult...">nelder_mead</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fcn</td><td>The function to evaluate. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">y</td><td>An array containing the function values at each vertex. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pcent</td><td>An array containing the centroid of vertex position information. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ihi</td><td>The index of the largest magnitude vertex. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">neval</td><td>The number of function evaluations. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">work</td><td>An N-element workspace array where N is the number of dimensions of the problem. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The new function estimate. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00214">214</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="ad09b33f9ff6f17e1cc0d56befa1a77b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09b33f9ff6f17e1cc0d56befa1a77b4">&#9670;&nbsp;</a></span>get_initial_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_optimize::nelder_mead::get_initial_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the size of the initial simplex that will be utilized by the Nelder-Mead algorithm in the event that the user does not supply a simplex geometry, or if the user supplies an invalid simplex geometry. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">pure</span> <span class="keywordtype">real(real64)</span> get_initial_size(<span class="keywordtype">class</span>(nelder_mead) this)</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1nelder__mead.html" title="Defines a solver based upon Nelder and Mead&#39;s simplex algorithm for minimization of functions of mult...">nelder_mead</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size of the simplex (length of an edge). </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00176">176</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="af262957b196243601501c8540ed6edf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af262957b196243601501c8540ed6edf2">&#9670;&nbsp;</a></span>get_simplex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_optimize::nelder_mead::get_simplex </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets an N-by-(N+1) matrix containing the current simplex. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">pure</span> <span class="keywordtype">real(real64)</span>(:,:) function get_simplex(<span class="keywordtype">class</span>(nelder_mead) this)</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1nelder__mead.html" title="Defines a solver based upon Nelder and Mead&#39;s simplex algorithm for minimization of functions of mult...">nelder_mead</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The N-by-(N+1) matrix containing the simplex. Each vertex of the simplex is stored as its own column of this matrix. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00145">145</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="a7a7e271e79bbf0249dc2a64fd2f46a46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a7e271e79bbf0249dc2a64fd2f46a46">&#9670;&nbsp;</a></span>set_initial_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_optimize::nelder_mead::set_initial_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the size of the initial simplex that will be utilized by the Nelder-Mead algorithm in the event that the user does not supply a simplex geometry, or if the user supplies an invalid simplex geometry. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">subroutine </span>set_initial_size(class(nelder_mead) this, real(real64) x)</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1nelder__mead.html" title="Defines a solver based upon Nelder and Mead&#39;s simplex algorithm for minimization of functions of mult...">nelder_mead</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The size of the simplex (length of an edge).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>example</dt><dd><div class="fragment"></div><!-- fragment --> </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00193">193</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="af135618858e807fc51ebd6063ac9c736"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af135618858e807fc51ebd6063ac9c736">&#9670;&nbsp;</a></span>set_simplex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_optimize::nelder_mead::set_simplex </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets an N-by-(N+1) matrix as the current simplex. Notice, if this matrix is different in size from the problem dimensionallity, the Nelder-Mead routine will replace it with an appropriately sized matrix. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">subroutine </span>set_simplex(class(nelder_mead) this, real(real64) x(:,:))</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1nelder__mead.html" title="Defines a solver based upon Nelder and Mead&#39;s simplex algorithm for minimization of functions of mult...">nelder_mead</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The simplex matrix. Each column of the matrix must contain the coordinates of each vertex of the simplex.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>example</dt><dd><div class="fragment"></div><!-- fragment --> </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00163">163</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="a1cc60f4f3daecc2f314fd02ab05854c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cc60f4f3daecc2f314fd02ab05854c6">&#9670;&nbsp;</a></span>solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_optimize::nelder_mead::solve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Utilizes the Nelder-Mead simplex method for finding a minimum value of the specified function. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">subroutine </span>solve(class(nelder_mead) this, class(fcnnvar_helper) fcn, real(real64) x(:), real(real64) fout, optional type(iteration_behavior) ib, optional class(errors) err)</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1nelder__mead.html" title="Defines a solver based upon Nelder and Mead&#39;s simplex algorithm for minimization of functions of mult...">nelder_mead</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fcn</td><td>The fcnnvar_helper object containing the equation to optimize. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>On input, the initial guess at the optimal point. On output, the updated optimal point estimate. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fout</td><td>An optional output, that if provided, returns the value of the function at <code>x</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ib</td><td>An optional output, that if provided, allows the caller to obtain iteration performance statistics. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional errors-based object that if provided can be used to retrieve information relating to any errors encountered during execution. If not provided, a default implementation of the errors class is used internally to provide error handling. Possible errors and warning messages that may be encountered are as follows.<ul>
<li>NL_INVALID_OPERATION_ERROR: Occurs if no equations have been defined.</li>
<li>NL_INVALID_INPUT_ERROR: Occurs if <code>x</code> is not appropriately sized for the problem as defined in <code>fcn</code>.</li>
<li>NL_OUT_OF_MEMORY_ERROR: Occurs if there is insufficient memory available.</li>
<li>NL_CONVERGENCE_ERROR: Occurs if the algorithm cannot converge within the allowed number of iterations.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Example</dt><dd>The following example illustrates how to find the minimum of Rosenbrock's function using this Nelder-Mead solver. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__optimize.html">nonlin_optimize</a>, <span class="keywordtype">only</span> : <a class="code" href="structnonlin__optimize_1_1nelder__mead.html">nelder_mead</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__core.html">nonlin_core</a>, <span class="keywordtype">only</span> : <a class="code" href="interfacenonlin__core_1_1fcnnvar.html">fcnnvar</a>, <a class="code" href="structnonlin__core_1_1fcnnvar__helper.html">fcnnvar_helper</a>, <a class="code" href="structnonlin__core_1_1iteration__behavior.html">iteration_behavior</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Local Variables</span></div><div class="line">    <span class="keywordtype">type</span>(nelder_mead) :: solver</div><div class="line">    <span class="keywordtype">type</span>(fcnnvar_helper) :: obj</div><div class="line">    <span class="keywordtype">procedure</span>(fcnnvar), <span class="keywordtype">pointer</span> :: fcn</div><div class="line">    <span class="keywordtype">real(real64)</span> :: x(2), fout</div><div class="line">    <span class="keywordtype">type</span>(iteration_behavior) :: ib</div><div class="line"></div><div class="line">    <span class="comment">! Initialization</span></div><div class="line">    fcn =&gt; rosenbrock</div><div class="line">    <span class="keyword">call </span>obj%set_fcn(fcn, 2)</div><div class="line"></div><div class="line">    <span class="comment">! Define an initial guess - the solution is (1, 1)</span></div><div class="line">    <span class="keyword">call </span>random_number(x)</div><div class="line"></div><div class="line">    <span class="comment">! Call the solver</span></div><div class="line">    <span class="keyword">call </span>solver%solve(obj, x, fout, ib)</div><div class="line"></div><div class="line">    <span class="comment">! Display the output</span></div><div class="line">    print <span class="stringliteral">&#39;(AF8.5AF8.5A)&#39;</span>, <span class="stringliteral">&quot;Rosenbrock Minimum: (&quot;</span>, x(1), <span class="stringliteral">&quot;, &quot;</span>, x(2), <span class="stringliteral">&quot;)&quot;</span></div><div class="line">    print <span class="stringliteral">&#39;(AE9.3)&#39;</span>, <span class="stringliteral">&quot;Function Value: &quot;</span>, fout</div><div class="line">    print <span class="stringliteral">&#39;(AI0)&#39;</span>, <span class="stringliteral">&quot;Iterations: &quot;</span>, ib%iter_count</div><div class="line">    print <span class="stringliteral">&#39;(AI0)&#39;</span>, <span class="stringliteral">&quot;Function Evaluations: &quot;</span>, ib%fcn_count</div><div class="line"><span class="keyword">contains</span></div><div class="line">    <span class="comment">! Rosenbrock&#39;s Function</span></div><div class="line"><span class="keyword">    function </span>rosenbrock(x) <span class="keyword">result</span>(f)</div><div class="line">        <span class="keywordtype">real(real64)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x</div><div class="line">        <span class="keywordtype">real(real64)</span> :: f</div><div class="line">        f = 1.0d2 * (x(2) - x(1)**2)**2 + (x(1) - 1.0d0)**2</div><div class="line"><span class="keyword">    end function</span></div><div class="line"><span class="keyword">end</span></div></div><!-- fragment --> The above program yields the following output. <div class="fragment"><div class="line">Rosenbrock Minimum: ( 1.00000,  1.00000)</div><div class="line">Function Value: 0.264E-12</div><div class="line">Iterations: 59</div><div class="line">Function Evaluations: 112</div></div><!-- fragment --></dd></dl>
<dl class="section user"><dt>Remarks</dt><dd>The implementation of the Nelder-Mead algorithm presented here is a slight modification of the original work of Nelder and Mead. The Numerical Recipes implementation is also quite similar. In fact, the Numerical Recipes section relating to reflection, contraction, etc. is leveraged for this implemetation.</dd></dl>
<dl class="section user"><dt>See Also</dt><dd><ul>
<li>Nelder, John A.; R. Mead (1965). "A simplex method for function
      minimization". Computer Journal. 7: 308–313.</li>
<li><a href="http://www.webpages.uidaho.edu/~fuchang/res/ANMS.pdf">Gao, Fuchang, Han, Lixing (2010). "Implementing the Nelder-Mead simplex algorithm with adaptive parameters."</a></li>
<li><a href="https://en.wikipedia.org/wiki/Nelder–Mead_method">Wikipedia</a></li>
<li><a href="http://numerical.recipes/">Numerical Recipes</a> </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00134">134</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<hr/>The documentation for this type was generated from the following file:<ul>
<li>D:/Projects/Code/nonlin/src/<a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacenonlin__optimize.html">nonlin_optimize</a></li><li class="navelem"><a class="el" href="structnonlin__optimize_1_1nelder__mead.html">nelder_mead</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
