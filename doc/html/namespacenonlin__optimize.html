<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>nonlin: nonlin_optimize Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">nonlin
   &#160;<span id="projectnumber">1.3.0</span>
   </div>
   <div id="projectbrief">A library that provides routines to compute the solutions to systems of nonlinear equations.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacenonlin__optimize.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">nonlin_optimize Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><b><a class="el" href="namespacenonlin__optimize.html" title="nonlin_optimize ">nonlin_optimize</a></b>  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__optimize_1_1bfgs.html">bfgs</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines a Broyden–Fletcher–Goldfarb–Shanno (BFGS) solver for minimization of functions of multiple variables.  <a href="structnonlin__optimize_1_1bfgs.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__optimize_1_1line__search__optimizer.html">line_search_optimizer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class describing equation optimizers that use a line search algorithm to improve convergence behavior.  <a href="structnonlin__optimize_1_1line__search__optimizer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__optimize_1_1nelder__mead.html">nelder_mead</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines a solver based upon Nelder and Mead's simplex algorithm for minimization of functions of multiple variables.  <a href="structnonlin__optimize_1_1nelder__mead.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a60585435e52fce5a02c0c46591b43996"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__optimize.html#a60585435e52fce5a02c0c46591b43996">nm_solve</a> (this, fcn, x, fout, ib, err)</td></tr>
<tr class="memdesc:a60585435e52fce5a02c0c46591b43996"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utilizes the Nelder-Mead simplex method for finding a minimum value of the specified function.  <a href="#a60585435e52fce5a02c0c46591b43996">More...</a><br /></td></tr>
<tr class="separator:a60585435e52fce5a02c0c46591b43996"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7adf182785b56e42b4b3a068683ff4ec"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__optimize.html#a7adf182785b56e42b4b3a068683ff4ec">nm_extrapolate</a> (this, fcn, y, pcent, ihi, fac, neval, work)</td></tr>
<tr class="memdesc:a7adf182785b56e42b4b3a068683ff4ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates by the specified factor through the simplex across from the largest point. If the extrapolation results in a better estimate, the current high point is replaced with the new estimate.  <a href="#a7adf182785b56e42b4b3a068683ff4ec">More...</a><br /></td></tr>
<tr class="separator:a7adf182785b56e42b4b3a068683ff4ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f9e8f8d83ce449d6b5736e208a2068e"><td class="memItemLeft" align="right" valign="top">pure real(real64) function, dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__optimize.html#a3f9e8f8d83ce449d6b5736e208a2068e">nm_get_simplex</a> (this)</td></tr>
<tr class="memdesc:a3f9e8f8d83ce449d6b5736e208a2068e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets an N-by-(N+1) matrix containing the current simplex.  <a href="#a3f9e8f8d83ce449d6b5736e208a2068e">More...</a><br /></td></tr>
<tr class="separator:a3f9e8f8d83ce449d6b5736e208a2068e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a116321a9be10de330c282172cbd2a5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__optimize.html#a9a116321a9be10de330c282172cbd2a5">nm_set_simplex</a> (this, x)</td></tr>
<tr class="memdesc:a9a116321a9be10de330c282172cbd2a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets an N-by-(N+1) matrix as the current simplex. Notice, if this matrix is different in size from the problem dimensionallity, the Nelder-Mead routine will replace it with an appropriately sized matrix.  <a href="#a9a116321a9be10de330c282172cbd2a5">More...</a><br /></td></tr>
<tr class="separator:a9a116321a9be10de330c282172cbd2a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f6c5c56c82b48bb670d1a3d2aabad41"><td class="memItemLeft" align="right" valign="top">pure real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__optimize.html#a8f6c5c56c82b48bb670d1a3d2aabad41">nm_get_size</a> (this)</td></tr>
<tr class="memdesc:a8f6c5c56c82b48bb670d1a3d2aabad41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the size of the initial simplex that will be utilized by the Nelder-Mead algorithm in the event that the user does not supply a simplex geometry, or if the user supplies an invalid simplex geometry.  <a href="#a8f6c5c56c82b48bb670d1a3d2aabad41">More...</a><br /></td></tr>
<tr class="separator:a8f6c5c56c82b48bb670d1a3d2aabad41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae25826079fd0155b04b992c54411140f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__optimize.html#ae25826079fd0155b04b992c54411140f">nm_set_size</a> (this, x)</td></tr>
<tr class="memdesc:ae25826079fd0155b04b992c54411140f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the size of the initial simplex that will be utilized by the Nelder-Mead algorithm in the event that the user does not supply a simplex geometry, or if the user supplies an invalid simplex geometry.  <a href="#ae25826079fd0155b04b992c54411140f">More...</a><br /></td></tr>
<tr class="separator:ae25826079fd0155b04b992c54411140f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96fd28469293f24e7164cbb5d3598deb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__optimize.html#a96fd28469293f24e7164cbb5d3598deb">lso_get_line_search</a> (this, ls)</td></tr>
<tr class="memdesc:a96fd28469293f24e7164cbb5d3598deb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the line search module.  <a href="#a96fd28469293f24e7164cbb5d3598deb">More...</a><br /></td></tr>
<tr class="separator:a96fd28469293f24e7164cbb5d3598deb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c97f643516c50677eb233a6f232be6f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__optimize.html#a3c97f643516c50677eb233a6f232be6f">lso_set_line_search</a> (this, ls)</td></tr>
<tr class="memdesc:a3c97f643516c50677eb233a6f232be6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the line search module.  <a href="#a3c97f643516c50677eb233a6f232be6f">More...</a><br /></td></tr>
<tr class="separator:a3c97f643516c50677eb233a6f232be6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0aa3b996621dbaf4e1f976183c1a34a4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__optimize.html#a0aa3b996621dbaf4e1f976183c1a34a4">lso_set_default</a> (this)</td></tr>
<tr class="memdesc:a0aa3b996621dbaf4e1f976183c1a34a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Establishes a default line_search object for the line search module.  <a href="#a0aa3b996621dbaf4e1f976183c1a34a4">More...</a><br /></td></tr>
<tr class="separator:a0aa3b996621dbaf4e1f976183c1a34a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70544b59fd90d3bf5391e2bbbba2be55"><td class="memItemLeft" align="right" valign="top">pure logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__optimize.html#a70544b59fd90d3bf5391e2bbbba2be55">lso_is_line_search_defined</a> (this)</td></tr>
<tr class="memdesc:a70544b59fd90d3bf5391e2bbbba2be55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests to see if a line search module is defined.  <a href="#a70544b59fd90d3bf5391e2bbbba2be55">More...</a><br /></td></tr>
<tr class="separator:a70544b59fd90d3bf5391e2bbbba2be55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a077c4f7114797b5a90c7cee8fb8cf834"><td class="memItemLeft" align="right" valign="top">pure logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__optimize.html#a077c4f7114797b5a90c7cee8fb8cf834">lso_get_use_search</a> (this)</td></tr>
<tr class="memdesc:a077c4f7114797b5a90c7cee8fb8cf834"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a value determining if a line-search should be employed.  <a href="#a077c4f7114797b5a90c7cee8fb8cf834">More...</a><br /></td></tr>
<tr class="separator:a077c4f7114797b5a90c7cee8fb8cf834"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e092a34e7b488b8c62bbf8f22095a38"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__optimize.html#a2e092a34e7b488b8c62bbf8f22095a38">lso_set_use_search</a> (this, x)</td></tr>
<tr class="memdesc:a2e092a34e7b488b8c62bbf8f22095a38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets a value determining if a line-search should be employed.  <a href="#a2e092a34e7b488b8c62bbf8f22095a38">More...</a><br /></td></tr>
<tr class="separator:a2e092a34e7b488b8c62bbf8f22095a38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee4fd0cfe097543fa9d93bd15ce59451"><td class="memItemLeft" align="right" valign="top">pure real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__optimize.html#aee4fd0cfe097543fa9d93bd15ce59451">lso_get_var_tol</a> (this)</td></tr>
<tr class="memdesc:aee4fd0cfe097543fa9d93bd15ce59451"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the convergence on change in variable tolerance.  <a href="#aee4fd0cfe097543fa9d93bd15ce59451">More...</a><br /></td></tr>
<tr class="separator:aee4fd0cfe097543fa9d93bd15ce59451"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada2f7899183fd3f86e89fc80d8636c7c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__optimize.html#ada2f7899183fd3f86e89fc80d8636c7c">lso_set_var_tol</a> (this, x)</td></tr>
<tr class="memdesc:ada2f7899183fd3f86e89fc80d8636c7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the convergence on change in variable tolerance.  <a href="#ada2f7899183fd3f86e89fc80d8636c7c">More...</a><br /></td></tr>
<tr class="separator:ada2f7899183fd3f86e89fc80d8636c7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad20de06d520ed8030f90c4b48dda3bbe"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__optimize.html#ad20de06d520ed8030f90c4b48dda3bbe">bfgs_solve</a> (this, fcn, x, fout, ib, err)</td></tr>
<tr class="memdesc:ad20de06d520ed8030f90c4b48dda3bbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utilizes the Broyden-Fletcher-Goldfarb-Shanno (BFGS) algorithm for finding a minimum value of the specified function.  <a href="#ad20de06d520ed8030f90c4b48dda3bbe">More...</a><br /></td></tr>
<tr class="separator:ad20de06d520ed8030f90c4b48dda3bbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><b><a class="el" href="namespacenonlin__optimize.html" title="nonlin_optimize ">nonlin_optimize</a></b> </p>
<dl class="section user"><dt>Purpose</dt><dd>To provide various optimization routines. </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ad20de06d520ed8030f90c4b48dda3bbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad20de06d520ed8030f90c4b48dda3bbe">&#9670;&nbsp;</a></span>bfgs_solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine nonlin_optimize::bfgs_solve </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__optimize_1_1bfgs.html">bfgs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structnonlin__types_1_1fcnnvar__helper.html">fcnnvar_helper</a>), intent(in)&#160;</td>
          <td class="paramname"><em>fcn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(out), optional&#160;</td>
          <td class="paramname"><em>fout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structnonlin__types_1_1iteration__behavior.html">iteration_behavior</a>), optional&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(errors), intent(inout), optional, target&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utilizes the Broyden-Fletcher-Goldfarb-Shanno (BFGS) algorithm for finding a minimum value of the specified function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The bfgs_mead object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fcn</td><td>The fcnnvar_helper object containing the equation to optimize. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>On input, the initial guess at the optimal point. On output, the updated optimal point estimate. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fout</td><td>An optional output, that if provided, returns the value of the function at <code>x</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ib</td><td>An optional output, that if provided, allows the caller to obtain iteration performance statistics. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional errors-based object that if provided can be used to retrieve information relating to any errors encountered during execution. If not provided, a default implementation of the errors class is used internally to provide error handling. Possible errors and warning messages that may be encountered are as follows.<ul>
<li>NL_INVALID_OPERATION_ERROR: Occurs if no equations have been defined.</li>
<li>NL_INVALID_INPUT_ERROR: Occurs if <code>x</code> is not appropriately sized for the problem as defined in <code>fcn</code>.</li>
<li>NL_OUT_OF_MEMORY_ERROR: Occurs if there is insufficient memory available.</li>
<li>NL_CONVERGENCE_ERROR: Occurs if the algorithm cannot converge within the allowed number of iterations.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Usage</dt><dd>The following example illustrates how to find the minimum of Rosenbrock's function using this BFGS solver. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span>linalg_constants, <span class="keywordtype">only</span> : dp, i32</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="interfacenonlin__types_1_1nonlin__optimize.html">nonlin_optimize</a>, <span class="keywordtype">only</span> : <a class="code" href="structnonlin__optimize_1_1bfgs.html">bfgs</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__types.html">nonlin_types</a>, <span class="keywordtype">only</span> : <a class="code" href="interfacenonlin__types_1_1fcnnvar.html">fcnnvar</a>, <a class="code" href="structnonlin__types_1_1fcnnvar__helper.html">fcnnvar_helper</a>, <a class="code" href="structnonlin__types_1_1iteration__behavior.html">iteration_behavior</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Local Variables</span></div><div class="line">    <span class="keywordtype">type</span>(bfgs) :: solver</div><div class="line">    <span class="keywordtype">type</span>(fcnnvar_helper) :: obj</div><div class="line">    <span class="keywordtype">procedure</span>(fcnnvar), <span class="keywordtype">pointer</span> :: fcn</div><div class="line">    <span class="keywordtype">real(real64)</span> :: x(2), fout</div><div class="line">    <span class="keywordtype">type</span>(iteration_behavior) :: ib</div><div class="line"></div><div class="line">    <span class="comment">! Initialization</span></div><div class="line">    fcn =&gt; rosenbrock</div><div class="line">    <span class="keyword">call </span>obj%set_fcn(fcn, 2)</div><div class="line"></div><div class="line">    <span class="comment">! Define an initial guess - the solution is (1, 1)</span></div><div class="line">    <span class="keyword">call </span>random_number(x)</div><div class="line"></div><div class="line">    <span class="comment">! Call the solver</span></div><div class="line">    <span class="keyword">call </span>solver%solve(obj, x, fout, ib)</div><div class="line"></div><div class="line">    <span class="comment">! Display the output</span></div><div class="line">    print <span class="stringliteral">&#39;(AF8.5AF8.5A)&#39;</span>, <span class="stringliteral">&quot;Rosenbrock Minimum: (&quot;</span>, x(1), <span class="stringliteral">&quot;, &quot;</span>, x(2), <span class="stringliteral">&quot;)&quot;</span></div><div class="line">    print <span class="stringliteral">&#39;(AE9.3)&#39;</span>, <span class="stringliteral">&quot;Function Value: &quot;</span>, fout</div><div class="line">    print <span class="stringliteral">&#39;(AI0)&#39;</span>, <span class="stringliteral">&quot;Iterations: &quot;</span>, ib%iter_count</div><div class="line">    print <span class="stringliteral">&#39;(AI0)&#39;</span>, <span class="stringliteral">&quot;Function Evaluations: &quot;</span>, ib%fcn_count</div><div class="line"><span class="keyword">contains</span></div><div class="line">    <span class="comment">! Rosenbrock&#39;s Function</span></div><div class="line"><span class="keyword">    function </span>rosenbrock(x) <span class="keyword">result</span>(f)</div><div class="line">        <span class="keywordtype">real(real64)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x</div><div class="line">        <span class="keywordtype">real(real64)</span> :: f</div><div class="line">        f = 1.0d2 * (x(2) - x(1)**2)**2 + (x(1) - 1.0d0)**2</div><div class="line"><span class="keyword">    end function</span></div><div class="line"><span class="keyword">end</span></div></div><!-- fragment --> The above program yields the following output: <div class="fragment"><div class="line">Rosenbrock Minimum: ( 1.00000,  0.99999)</div><div class="line">Function Value: 0.200E-10</div><div class="line">Iterations: 47</div><div class="line">Function Evaluations: 70</div></div><!-- fragment --></dd></dl>
<dl class="section user"><dt>See Also</dt><dd><ul>
<li><a href="https://en.wikipedia.org/wiki/Broyden%E2%80%93Fletcher%E2%80%93Goldfarb%E2%80%93Shanno_algorithm">Wikipedia - BFGS Methods</a></li>
<li><a href="https://en.wikipedia.org/wiki/Quasi-Newton_method">Wikipedia - Quasi-Newton Methods</a></li>
<li><a href="https://www.cs.ubc.ca/~schmidtm/Software/minFunc.html">minFunc</a> </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00731">731</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="a96fd28469293f24e7164cbb5d3598deb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96fd28469293f24e7164cbb5d3598deb">&#9670;&nbsp;</a></span>lso_get_line_search()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine nonlin_optimize::lso_get_line_search </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__optimize_1_1line__search__optimizer.html">line_search_optimizer</a>), intent(in)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structnonlin__linesearch_1_1line__search.html">line_search</a>), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>ls</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the line search module. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1line__search__optimizer.html" title="A class describing equation optimizers that use a line search algorithm to improve convergence behavi...">line_search_optimizer</a> object. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ls</td><td>The line_search object. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00565">565</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="a077c4f7114797b5a90c7cee8fb8cf834"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a077c4f7114797b5a90c7cee8fb8cf834">&#9670;&nbsp;</a></span>lso_get_use_search()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure logical function nonlin_optimize::lso_get_use_search </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__optimize_1_1line__search__optimizer.html">line_search_optimizer</a>), intent(in)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a value determining if a line-search should be employed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1line__search__optimizer.html" title="A class describing equation optimizers that use a line search algorithm to improve convergence behavi...">line_search_optimizer</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if a line search should be used; else, false. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00611">611</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="aee4fd0cfe097543fa9d93bd15ce59451"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee4fd0cfe097543fa9d93bd15ce59451">&#9670;&nbsp;</a></span>lso_get_var_tol()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure real(real64) function nonlin_optimize::lso_get_var_tol </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__optimize_1_1line__search__optimizer.html">line_search_optimizer</a>), intent(in)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the convergence on change in variable tolerance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1line__search__optimizer.html" title="A class describing equation optimizers that use a line search algorithm to improve convergence behavi...">line_search_optimizer</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The tolerance value. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00633">633</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="a70544b59fd90d3bf5391e2bbbba2be55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70544b59fd90d3bf5391e2bbbba2be55">&#9670;&nbsp;</a></span>lso_is_line_search_defined()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure logical function nonlin_optimize::lso_is_line_search_defined </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__optimize_1_1line__search__optimizer.html">line_search_optimizer</a>), intent(in)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tests to see if a line search module is defined. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1line__search__optimizer.html" title="A class describing equation optimizers that use a line search algorithm to improve convergence behavi...">line_search_optimizer</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if a module is defined; else, false. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00600">600</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="a0aa3b996621dbaf4e1f976183c1a34a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0aa3b996621dbaf4e1f976183c1a34a4">&#9670;&nbsp;</a></span>lso_set_default()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine nonlin_optimize::lso_set_default </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__optimize_1_1line__search__optimizer.html">line_search_optimizer</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Establishes a default line_search object for the line search module. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1line__search__optimizer.html" title="A class describing equation optimizers that use a line search algorithm to improve convergence behavi...">line_search_optimizer</a> object. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00589">589</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="a3c97f643516c50677eb233a6f232be6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c97f643516c50677eb233a6f232be6f">&#9670;&nbsp;</a></span>lso_set_line_search()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine nonlin_optimize::lso_set_line_search </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__optimize_1_1line__search__optimizer.html">line_search_optimizer</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structnonlin__linesearch_1_1line__search.html">line_search</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ls</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the line search module. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1line__search__optimizer.html" title="A class describing equation optimizers that use a line search algorithm to improve convergence behavi...">line_search_optimizer</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ls</td><td>The line_search object. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00577">577</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="a2e092a34e7b488b8c62bbf8f22095a38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e092a34e7b488b8c62bbf8f22095a38">&#9670;&nbsp;</a></span>lso_set_use_search()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine nonlin_optimize::lso_set_use_search </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__optimize_1_1line__search__optimizer.html">line_search_optimizer</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets a value determining if a line-search should be employed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1line__search__optimizer.html" title="A class describing equation optimizers that use a line search algorithm to improve convergence behavi...">line_search_optimizer</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Set to true if a line search should be used; else, false. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00622">622</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="ada2f7899183fd3f86e89fc80d8636c7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada2f7899183fd3f86e89fc80d8636c7c">&#9670;&nbsp;</a></span>lso_set_var_tol()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine nonlin_optimize::lso_set_var_tol </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__optimize_1_1line__search__optimizer.html">line_search_optimizer</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the convergence on change in variable tolerance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1line__search__optimizer.html" title="A class describing equation optimizers that use a line search algorithm to improve convergence behavi...">line_search_optimizer</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The tolerance value. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00644">644</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="a7adf182785b56e42b4b3a068683ff4ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7adf182785b56e42b4b3a068683ff4ec">&#9670;&nbsp;</a></span>nm_extrapolate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function nonlin_optimize::nm_extrapolate </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__optimize_1_1nelder__mead.html">nelder_mead</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structnonlin__types_1_1fcnnvar__helper.html">fcnnvar_helper</a>), intent(in)&#160;</td>
          <td class="paramname"><em>fcn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>pcent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(int32), intent(in)&#160;</td>
          <td class="paramname"><em>ihi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>fac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(int32), intent(inout)&#160;</td>
          <td class="paramname"><em>neval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>work</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extrapolates by the specified factor through the simplex across from the largest point. If the extrapolation results in a better estimate, the current high point is replaced with the new estimate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1nelder__mead.html" title="Defines a solver based upon Nelder and Mead&#39;s simplex algorithm for minimization of functions of mult...">nelder_mead</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fcn</td><td>The function to evaluate. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">y</td><td>An array containing the function values at each vertex. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pcent</td><td>An array containing the centroid of vertex position information. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ihi</td><td>The index of the largest magnitude vertex. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">neval</td><td>The number of function evaluations. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">work</td><td>An N-element workspace array where N is the number of dimensions of the problem. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The new function estimate. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00447">447</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="a3f9e8f8d83ce449d6b5736e208a2068e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f9e8f8d83ce449d6b5736e208a2068e">&#9670;&nbsp;</a></span>nm_get_simplex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure real(real64) function, dimension(:,:), allocatable nonlin_optimize::nm_get_simplex </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__optimize_1_1nelder__mead.html">nelder_mead</a>), intent(in)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets an N-by-(N+1) matrix containing the current simplex. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1nelder__mead.html" title="Defines a solver based upon Nelder and Mead&#39;s simplex algorithm for minimization of functions of mult...">nelder_mead</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The N-by-(N+1) matrix containing the simplex. Each vertex of the simplex is stored as its own column of this matrix. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00494">494</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="a8f6c5c56c82b48bb670d1a3d2aabad41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f6c5c56c82b48bb670d1a3d2aabad41">&#9670;&nbsp;</a></span>nm_get_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure real(real64) function nonlin_optimize::nm_get_size </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__optimize_1_1nelder__mead.html">nelder_mead</a>), intent(in)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the size of the initial simplex that will be utilized by the Nelder-Mead algorithm in the event that the user does not supply a simplex geometry, or if the user supplies an invalid simplex geometry. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1nelder__mead.html" title="Defines a solver based upon Nelder and Mead&#39;s simplex algorithm for minimization of functions of mult...">nelder_mead</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size of the simplex (length of an edge). </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00539">539</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="a9a116321a9be10de330c282172cbd2a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a116321a9be10de330c282172cbd2a5">&#9670;&nbsp;</a></span>nm_set_simplex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine nonlin_optimize::nm_set_simplex </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__optimize_1_1nelder__mead.html">nelder_mead</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:,:)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets an N-by-(N+1) matrix as the current simplex. Notice, if this matrix is different in size from the problem dimensionallity, the Nelder-Mead routine will replace it with an appropriately sized matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1nelder__mead.html" title="Defines a solver based upon Nelder and Mead&#39;s simplex algorithm for minimization of functions of mult...">nelder_mead</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The simplex matrix. Each column of the matrix must contain the coordinates of each vertex of the simplex. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00514">514</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="ae25826079fd0155b04b992c54411140f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae25826079fd0155b04b992c54411140f">&#9670;&nbsp;</a></span>nm_set_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine nonlin_optimize::nm_set_size </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__optimize_1_1nelder__mead.html">nelder_mead</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the size of the initial simplex that will be utilized by the Nelder-Mead algorithm in the event that the user does not supply a simplex geometry, or if the user supplies an invalid simplex geometry. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1nelder__mead.html" title="Defines a solver based upon Nelder and Mead&#39;s simplex algorithm for minimization of functions of mult...">nelder_mead</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The size of the simplex (length of an edge). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00552">552</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="a60585435e52fce5a02c0c46591b43996"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60585435e52fce5a02c0c46591b43996">&#9670;&nbsp;</a></span>nm_solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine nonlin_optimize::nm_solve </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__optimize_1_1nelder__mead.html">nelder_mead</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structnonlin__types_1_1fcnnvar__helper.html">fcnnvar_helper</a>), intent(in)&#160;</td>
          <td class="paramname"><em>fcn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(out), optional&#160;</td>
          <td class="paramname"><em>fout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structnonlin__types_1_1iteration__behavior.html">iteration_behavior</a>), optional&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(errors), intent(inout), optional, target&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utilizes the Nelder-Mead simplex method for finding a minimum value of the specified function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1nelder__mead.html" title="Defines a solver based upon Nelder and Mead&#39;s simplex algorithm for minimization of functions of mult...">nelder_mead</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fcn</td><td>The fcnnvar_helper object containing the equation to optimize. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>On input, the initial guess at the optimal point. On output, the updated optimal point estimate. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fout</td><td>An optional output, that if provided, returns the value of the function at <code>x</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ib</td><td>An optional output, that if provided, allows the caller to obtain iteration performance statistics. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional errors-based object that if provided can be used to retrieve information relating to any errors encountered during execution. If not provided, a default implementation of the errors class is used internally to provide error handling. Possible errors and warning messages that may be encountered are as follows.<ul>
<li>NL_INVALID_OPERATION_ERROR: Occurs if no equations have been defined.</li>
<li>NL_INVALID_INPUT_ERROR: Occurs if <code>x</code> is not appropriately sized for the problem as defined in <code>fcn</code>.</li>
<li>NL_OUT_OF_MEMORY_ERROR: Occurs if there is insufficient memory available.</li>
<li>NL_CONVERGENCE_ERROR: Occurs if the algorithm cannot converge within the allowed number of iterations.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Usage</dt><dd>The following example illustrates how to find the minimum of Rosenbrock's function using this Nelder-Mead solver. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span>linalg_constants, <span class="keywordtype">only</span> : dp, i32</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="interfacenonlin__types_1_1nonlin__optimize.html">nonlin_optimize</a>, <span class="keywordtype">only</span> : <a class="code" href="structnonlin__optimize_1_1nelder__mead.html">nelder_mead</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__types.html">nonlin_types</a>, <span class="keywordtype">only</span> : <a class="code" href="interfacenonlin__types_1_1fcnnvar.html">fcnnvar</a>, <a class="code" href="structnonlin__types_1_1fcnnvar__helper.html">fcnnvar_helper</a>, <a class="code" href="structnonlin__types_1_1iteration__behavior.html">iteration_behavior</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Local Variables</span></div><div class="line">    <span class="keywordtype">type</span>(nelder_mead) :: solver</div><div class="line">    <span class="keywordtype">type</span>(fcnnvar_helper) :: obj</div><div class="line">    <span class="keywordtype">procedure</span>(fcnnvar), <span class="keywordtype">pointer</span> :: fcn</div><div class="line">    <span class="keywordtype">real(real64)</span> :: x(2), fout</div><div class="line">    <span class="keywordtype">type</span>(iteration_behavior) :: ib</div><div class="line"></div><div class="line">    <span class="comment">! Initialization</span></div><div class="line">    fcn =&gt; rosenbrock</div><div class="line">    <span class="keyword">call </span>obj%set_fcn(fcn, 2)</div><div class="line"></div><div class="line">    <span class="comment">! Define an initial guess - the solution is (1, 1)</span></div><div class="line">    <span class="keyword">call </span>random_number(x)</div><div class="line"></div><div class="line">    <span class="comment">! Call the solver</span></div><div class="line">    <span class="keyword">call </span>solver%solve(obj, x, fout, ib)</div><div class="line"></div><div class="line">    <span class="comment">! Display the output</span></div><div class="line">    print <span class="stringliteral">&#39;(AF8.5AF8.5A)&#39;</span>, <span class="stringliteral">&quot;Rosenbrock Minimum: (&quot;</span>, x(1), <span class="stringliteral">&quot;, &quot;</span>, x(2), <span class="stringliteral">&quot;)&quot;</span></div><div class="line">    print <span class="stringliteral">&#39;(AE9.3)&#39;</span>, <span class="stringliteral">&quot;Function Value: &quot;</span>, fout</div><div class="line">    print <span class="stringliteral">&#39;(AI0)&#39;</span>, <span class="stringliteral">&quot;Iterations: &quot;</span>, ib%iter_count</div><div class="line">    print <span class="stringliteral">&#39;(AI0)&#39;</span>, <span class="stringliteral">&quot;Function Evaluations: &quot;</span>, ib%fcn_count</div><div class="line"><span class="keyword">contains</span></div><div class="line">    <span class="comment">! Rosenbrock&#39;s Function</span></div><div class="line"><span class="keyword">    function </span>rosenbrock(x) <span class="keyword">result</span>(f)</div><div class="line">        <span class="keywordtype">real(real64)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x</div><div class="line">        <span class="keywordtype">real(real64)</span> :: f</div><div class="line">        f = 1.0d2 * (x(2) - x(1)**2)**2 + (x(1) - 1.0d0)**2</div><div class="line"><span class="keyword">    end function</span></div><div class="line"><span class="keyword">end</span></div></div><!-- fragment --> The above program yields the following output: <div class="fragment"><div class="line">Rosenbrock Minimum: ( 1.00000,  1.00000)</div><div class="line">Function Value: 0.264E-12</div><div class="line">Iterations: 59</div><div class="line">Function Evaluations: 112</div></div><!-- fragment --></dd></dl>
<dl class="section user"><dt>Remarks</dt><dd>The implementation of the Nelder-Mead algorithm presented here is a slight modification of the original work of Nelder and Mead. The Numerical Recipes implementation is also quite similar. In fact, the Numerical Recipes section relating to reflection, contraction, etc. is leveraged for this implemetation.</dd></dl>
<dl class="section user"><dt>See Also</dt><dd><ul>
<li>Nelder, John A.; R. Mead (1965). "A simplex method for function
      minimization". Computer Journal. 7: 308–313.</li>
<li><a href="http://www.webpages.uidaho.edu/~fuchang/res/ANMS.pdf">Gao, Fuchang, Han, Lixing (2010). "Implementing the Nelder-Mead simplex algorithm with adaptive parameters."</a></li>
<li><a href="https://en.wikipedia.org/wiki/Nelder–Mead_method">Wikipedia</a></li>
<li><a href="http://numerical.recipes/">Numerical Recipes</a> </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00196">196</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacenonlin__optimize.html">nonlin_optimize</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
