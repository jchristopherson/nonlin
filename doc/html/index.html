<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>nonlin: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">nonlin
   &#160;<span id="projectnumber">1.3.0</span>
   </div>
   <div id="projectbrief">A library that provides routines to compute the solutions to systems of nonlinear equations.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">nonlin Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>NONLIN is a library that provides routines for solving least squares problems, systems of equations, and single equations. The library provides function optimization routines. There are also specific routines and data types optimized for operation on polynomials.</p>
<dl class="section user"><dt></dt><dd>The example below illustrates two techniques of determining the roots of a polynomial using routines and data types provided by this library. <div class="image">
<img src="Cubic_Roots_Example.png" alt="Cubic_Roots_Example.png"/>
</div>
 <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span>iso_fortran_env</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__core.html">nonlin_core</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__solve.html">nonlin_solve</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Local variables</span></div><div class="line">    <span class="keywordtype">type</span>(fcn1var_helper) :: obj</div><div class="line">    <span class="keywordtype">procedure</span>(fcn1var), <span class="keywordtype">pointer</span> :: fcn</div><div class="line">    <span class="keywordtype">type</span>(newton_1var_solver) :: solver</div><div class="line">    <span class="keywordtype">real(real64)</span> :: x, f</div><div class="line">    <span class="keywordtype">type</span>(value_pair) :: limits</div><div class="line">    <span class="keywordtype">type</span>(iteration_behavior) :: tracking</div><div class="line"></div><div class="line">    <span class="comment">! Define the search limits</span></div><div class="line">    limits%x1 = 2.0d0</div><div class="line">    limits%x2 = -2.0d0</div><div class="line"></div><div class="line">    <span class="comment">! Establish the function</span></div><div class="line">    fcn =&gt; fcn1</div><div class="line">    <span class="keyword">call </span>obj%set_fcn(fcn)</div><div class="line"></div><div class="line">    <span class="comment">! Allow the solver to print out updates at each iteration</span></div><div class="line">    <span class="keyword">call </span>solver%set_print_status(.true.)</div><div class="line"></div><div class="line">    <span class="comment">! Solve the equation</span></div><div class="line">    <span class="keyword">call </span>solver%solve(obj, x, limits, f, ib = tracking)</div><div class="line"></div><div class="line">    <span class="comment">! Print the output, residual, and details regarding the iteration</span></div><div class="line">    print *, <span class="stringliteral">&quot;&quot;</span></div><div class="line">    print <span class="stringliteral">&#39;(AF7.5)&#39;</span>, <span class="stringliteral">&quot;The solution: &quot;</span>, x</div><div class="line">    print <span class="stringliteral">&#39;(AE10.3)&#39;</span>, <span class="stringliteral">&quot;The residual: &quot;</span>, f</div><div class="line">    print <span class="stringliteral">&#39;(AI0)&#39;</span>, <span class="stringliteral">&quot;Iterations: &quot;</span>, tracking%iter_count</div><div class="line">    print <span class="stringliteral">&#39;(AI0)&#39;</span>, <span class="stringliteral">&quot;Function Evaluations: &quot;</span>, tracking%fcn_count</div><div class="line">    print <span class="stringliteral">&#39;(AI0)&#39;</span>, <span class="stringliteral">&quot;Derivative Evaluations: &quot;</span>, tracking%jacobian_count</div><div class="line">    print <span class="stringliteral">&#39;(AL1)&#39;</span>, <span class="stringliteral">&quot;Converge on Function Value: &quot;</span>, tracking%converge_on_fcn</div><div class="line">    print <span class="stringliteral">&#39;(AL1)&#39;</span>, <span class="stringliteral">&quot;Converge on Change in Variable: &quot;</span>, tracking%converge_on_chng</div><div class="line">    print <span class="stringliteral">&#39;(AL1)&#39;</span>, <span class="stringliteral">&quot;Converge on Derivative: &quot;</span>, tracking%converge_on_zero_diff</div><div class="line"></div><div class="line"><span class="keyword">contains</span></div><div class="line">    <span class="comment">! The function:</span></div><div class="line">    <span class="comment">! f(x) = x**3 - 2 * x - 1</span></div><div class="line"><span class="keyword">    function </span>fcn1(x) <span class="keyword">result</span>(f)</div><div class="line">        <span class="keywordtype">real(real64)</span>, <span class="keywordtype">intent(in)</span> :: x</div><div class="line">        <span class="keywordtype">real(real64)</span> :: f</div><div class="line">        f = x**3 - 2.0d0 * x - 1.0d0</div><div class="line"><span class="keyword">    end function</span></div><div class="line"><span class="keyword">end program</span></div></div><!-- fragment --> The above program produces the following output. <div class="fragment"><div class="line">Iteration: 1</div><div class="line">Function Evaluations: 4</div><div class="line">Jacobian Evaluations: 2</div><div class="line">Change in Variable: 0.500E+00</div><div class="line">Residual: -.125E+00</div><div class="line"></div><div class="line">Iteration: 2</div><div class="line">Function Evaluations: 5</div><div class="line">Jacobian Evaluations: 3</div><div class="line">Change in Variable: 0.125E+01</div><div class="line">Residual: -.208E+01</div><div class="line"></div><div class="line">Iteration: 3</div><div class="line">Function Evaluations: 6</div><div class="line">Jacobian Evaluations: 4</div><div class="line">Change in Variable: 0.625E+00</div><div class="line">Residual: -.115E+01</div><div class="line"></div><div class="line">Iteration: 4</div><div class="line">Function Evaluations: 7</div><div class="line">Jacobian Evaluations: 5</div><div class="line">Change in Variable: -.313E+00</div><div class="line">Residual: 0.436E+00</div><div class="line"></div><div class="line">Iteration: 5</div><div class="line">Function Evaluations: 8</div><div class="line">Jacobian Evaluations: 6</div><div class="line">Change in Variable: 0.665E-01</div><div class="line">Residual: 0.221E-01</div><div class="line"></div><div class="line">Iteration: 6</div><div class="line">Function Evaluations: 9</div><div class="line">Jacobian Evaluations: 7</div><div class="line">Change in Variable: 0.375E-02</div><div class="line">Residual: 0.685E-04</div><div class="line"></div><div class="line">The solution: 1.61803</div><div class="line">The residual:  0.665E-09</div><div class="line">Iterations: 7</div><div class="line">Function Evaluations: 11</div><div class="line">Derivative Evaluations: 8</div><div class="line">Converge on Function Value: T</div><div class="line">Converge on Change in Variable: F</div><div class="line">Converge on Derivative: F</div></div><!-- fragment --> </dd></dl>
<dl class="section user"><dt></dt><dd>An alternative for determining the roots of a polynomial is to use the polynomial type from this library, and determine the roots using the functionallity of that type. The following example illustrates just such an approach. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span>iso_fortran_env</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__polynomials.html">nonlin_polynomials</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Local Variables</span></div><div class="line">    <span class="keywordtype">type</span>(polynomial) :: f</div><div class="line">    <span class="keywordtype">real(real64)</span> :: coeffs(4)</div><div class="line">    <span class="keywordtype">complex(real64)</span>, <span class="keywordtype">allocatable</span> :: rts(:)</div><div class="line">    <span class="keywordtype">integer(int32)</span> :: i</div><div class="line"></div><div class="line">    <span class="comment">! Define the polynomial (x**3 - 2 * x - 1)</span></div><div class="line">    coeffs = [-1.0d0, -2.0d0, 0.0d0, 1.0d0]</div><div class="line">    f = coeffs</div><div class="line"></div><div class="line">    <span class="comment">! Compute the polynomial roots</span></div><div class="line">    rts = f%roots()</div><div class="line"></div><div class="line">    <span class="comment">! Display the results</span></div><div class="line">    <span class="keywordflow">do</span> i = 1, <span class="keyword">size</span>(rts)</div><div class="line">        print <span class="stringliteral">&#39;(AI0AF9.6AF9.6A)&#39;</span>, <span class="stringliteral">&quot;Root &quot;</span>, i, <span class="stringliteral">&quot; = (&quot;</span>, <span class="keywordtype">real(rts(i), real64)</span>, &amp;</div><div class="line">            <span class="stringliteral">&quot;, &quot;</span>, aimag(rts(i)), <span class="stringliteral">&quot;)&quot;</span></div><div class="line"><span class="keywordflow">    end do</span></div><div class="line"><span class="keyword">end program</span></div></div><!-- fragment --> The above program produces the following output. <div class="fragment"><div class="line">Root 1 = (-1.000000,  0.000000)</div><div class="line">Root 2 = (-0.618034,  0.000000)</div><div class="line">Root 3 = ( 1.618034,  0.000000)</div></div><!-- fragment --> </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
