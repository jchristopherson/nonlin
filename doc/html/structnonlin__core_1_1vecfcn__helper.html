<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>nonlin: nonlin_core::vecfcn_helper Type Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">nonlin
   &#160;<span id="projectnumber">1.3.0</span>
   </div>
   <div id="projectbrief">A library that provides routines to compute the solutions to systems of nonlinear equations.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('structnonlin__core_1_1vecfcn__helper.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="structnonlin__core_1_1vecfcn__helper-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">nonlin_core::vecfcn_helper Type Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Defines a type capable of encapsulating a system of nonlinear equations of the form: F(X) = 0. This type is used to establish the system of equations to solve, and provides a means for computing the Jacobian matrix for the system of equations, and any other ancillary operations that may be needed by the solver.  
 <a href="structnonlin__core_1_1vecfcn__helper.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a41b867ae18398e8c7de44c6dc5b32aed"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1vecfcn__helper.html#a41b867ae18398e8c7de44c6dc5b32aed">set_fcn</a> =&gt; vfh_set_fcn</td></tr>
<tr class="memdesc:a41b867ae18398e8c7de44c6dc5b32aed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Establishes a pointer to the routine containing the system of equations to solve.  <a href="#a41b867ae18398e8c7de44c6dc5b32aed">More...</a><br /></td></tr>
<tr class="separator:a41b867ae18398e8c7de44c6dc5b32aed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28ad419ee7fd8d7f0529587d4a1bfc78"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1vecfcn__helper.html#a28ad419ee7fd8d7f0529587d4a1bfc78">set_jacobian</a> =&gt; vfh_set_jac</td></tr>
<tr class="memdesc:a28ad419ee7fd8d7f0529587d4a1bfc78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Establishes a pointer to the routine for computing the Jacobian matrix of the system of equations. If no routine is defined, the Jacobian matrix will be computed numerically (this is the default state).  <a href="#a28ad419ee7fd8d7f0529587d4a1bfc78">More...</a><br /></td></tr>
<tr class="separator:a28ad419ee7fd8d7f0529587d4a1bfc78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5a78dc12bfaca9c6ee6a129611f6fae"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1vecfcn__helper.html#ae5a78dc12bfaca9c6ee6a129611f6fae">is_fcn_defined</a> =&gt; vfh_is_fcn_defined</td></tr>
<tr class="memdesc:ae5a78dc12bfaca9c6ee6a129611f6fae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests if the pointer to the subroutine containing the system of equations to solve has been assigned.  <a href="#ae5a78dc12bfaca9c6ee6a129611f6fae">More...</a><br /></td></tr>
<tr class="separator:ae5a78dc12bfaca9c6ee6a129611f6fae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95d28720ced834b78276792bc388ae3b"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1vecfcn__helper.html#a95d28720ced834b78276792bc388ae3b">is_jacobian_defined</a> =&gt; vfh_is_jac_defined</td></tr>
<tr class="memdesc:a95d28720ced834b78276792bc388ae3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests if the pointer to the subroutine containing the system of equations to solve has been assigned.  <a href="#a95d28720ced834b78276792bc388ae3b">More...</a><br /></td></tr>
<tr class="separator:a95d28720ced834b78276792bc388ae3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44c03a753473e7cc38776bf2005e1eb8"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1vecfcn__helper.html#a44c03a753473e7cc38776bf2005e1eb8">fcn</a> =&gt; vfh_fcn</td></tr>
<tr class="memdesc:a44c03a753473e7cc38776bf2005e1eb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes the routine containing the system of equations to solve. No action is taken if the pointer to the subroutine has not been defined.  <a href="#a44c03a753473e7cc38776bf2005e1eb8">More...</a><br /></td></tr>
<tr class="separator:a44c03a753473e7cc38776bf2005e1eb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb314c2501d0e7a1c973999c204abf8a"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1vecfcn__helper.html#abb314c2501d0e7a1c973999c204abf8a">jacobian</a> =&gt; vfh_jac_fcn</td></tr>
<tr class="memdesc:abb314c2501d0e7a1c973999c204abf8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes the routine containing the Jacobian matrix if supplied. If not supplied, the Jacobian is computed via finite differences.  <a href="#abb314c2501d0e7a1c973999c204abf8a">More...</a><br /></td></tr>
<tr class="separator:abb314c2501d0e7a1c973999c204abf8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7d7b04b2705a59abf9f3533f65b9982"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1vecfcn__helper.html#ab7d7b04b2705a59abf9f3533f65b9982">get_equation_count</a> =&gt; vfh_get_nfcn</td></tr>
<tr class="memdesc:ab7d7b04b2705a59abf9f3533f65b9982"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the number of equations in this system.  <a href="#ab7d7b04b2705a59abf9f3533f65b9982">More...</a><br /></td></tr>
<tr class="separator:ab7d7b04b2705a59abf9f3533f65b9982"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9531f2873b46cdbfd446a911cc285fc"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1vecfcn__helper.html#ab9531f2873b46cdbfd446a911cc285fc">get_variable_count</a> =&gt; vfh_get_nvar</td></tr>
<tr class="memdesc:ab9531f2873b46cdbfd446a911cc285fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the number of variables in this system.  <a href="#ab9531f2873b46cdbfd446a911cc285fc">More...</a><br /></td></tr>
<tr class="separator:ab9531f2873b46cdbfd446a911cc285fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a1ad69c2d6a5b32c041c93eb9cc542109"><td class="memItemLeft" align="right" valign="top"><a id="a1ad69c2d6a5b32c041c93eb9cc542109"></a>
procedure(<a class="el" href="interfacenonlin__core_1_1vecfcn.html">vecfcn</a>), pointer, nopass&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1vecfcn__helper.html#a1ad69c2d6a5b32c041c93eb9cc542109">m_fcn</a> =&gt; null()</td></tr>
<tr class="memdesc:a1ad69c2d6a5b32c041c93eb9cc542109"><td class="mdescLeft">&#160;</td><td class="mdescRight">A pointer to the target vecfcn routine. <br /></td></tr>
<tr class="separator:a1ad69c2d6a5b32c041c93eb9cc542109"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47cdc8d1382ba9ca635e94ae8758115d"><td class="memItemLeft" align="right" valign="top"><a id="a47cdc8d1382ba9ca635e94ae8758115d"></a>
procedure(<a class="el" href="interfacenonlin__core_1_1jacobianfcn.html">jacobianfcn</a>), pointer, nopass&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1vecfcn__helper.html#a47cdc8d1382ba9ca635e94ae8758115d">m_jac</a> =&gt; null()</td></tr>
<tr class="memdesc:a47cdc8d1382ba9ca635e94ae8758115d"><td class="mdescLeft">&#160;</td><td class="mdescRight">A pointer to the jacobian routine - null if no routine is supplied. <br /></td></tr>
<tr class="separator:a47cdc8d1382ba9ca635e94ae8758115d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a806818129d5723b7ff880af149e32a8c"><td class="memItemLeft" align="right" valign="top"><a id="a806818129d5723b7ff880af149e32a8c"></a>
integer(int32)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1vecfcn__helper.html#a806818129d5723b7ff880af149e32a8c">m_nfcn</a> = 0</td></tr>
<tr class="memdesc:a806818129d5723b7ff880af149e32a8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of functions in m_fcn. <br /></td></tr>
<tr class="separator:a806818129d5723b7ff880af149e32a8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac828cd0e3de7036ced8bae4b11664818"><td class="memItemLeft" align="right" valign="top"><a id="ac828cd0e3de7036ced8bae4b11664818"></a>
integer(int32)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1vecfcn__helper.html#ac828cd0e3de7036ced8bae4b11664818">m_nvar</a> = 0</td></tr>
<tr class="memdesc:ac828cd0e3de7036ced8bae4b11664818"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of variables in m_fcn. <br /></td></tr>
<tr class="separator:ac828cd0e3de7036ced8bae4b11664818"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Defines a type capable of encapsulating a system of nonlinear equations of the form: F(X) = 0. This type is used to establish the system of equations to solve, and provides a means for computing the Jacobian matrix for the system of equations, and any other ancillary operations that may be needed by the solver. </p>
<dl class="section user"><dt>Example</dt><dd>The following example illustrates the most basic use of this type to solve a system of 2 equations and 2 unknowns using Newton's method. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span>iso_fortran_env</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__core.html">nonlin_core</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__solve.html">nonlin_solve</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Local Variables</span></div><div class="line">    <span class="keywordtype">type</span>(vecfcn_helper) :: obj</div><div class="line">    <span class="keywordtype">procedure</span>(vecfcn), <span class="keywordtype">pointer</span> :: fcn</div><div class="line">    <span class="keywordtype">type</span>(newton_solver) :: solver</div><div class="line">    <span class="keywordtype">real(real64)</span> :: x(2), f(2)</div><div class="line"></div><div class="line">    <span class="comment">! Assign a pointer to the subroutine containing the equations to solve</span></div><div class="line">    fcn =&gt; fcns</div><div class="line">    <span class="keyword">call </span>obj%set_fcn(fcn, 2, 2) <span class="comment">! There are 2 equations with 2 unknowns</span></div><div class="line"></div><div class="line">    <span class="comment">! Define an initial guess</span></div><div class="line">    x = 1.0d0 <span class="comment">! Equivalent to x = [1.0d0, 1.0d0]</span></div><div class="line"></div><div class="line">    <span class="comment">! Solve the system of equations</span></div><div class="line">    <span class="keyword">call </span>solver%solve(obj, x, f)</div><div class="line"></div><div class="line">    <span class="comment">! Display the output</span></div><div class="line">    print <span class="stringliteral">&#39;(AF7.5AF7.5A)&#39;</span>, <span class="stringliteral">&quot;Solution: (&quot;</span>, x(1), <span class="stringliteral">&quot;, &quot;</span>, x(2), <span class="stringliteral">&quot;)&quot;</span></div><div class="line">    print <span class="stringliteral">&#39;(AE9.3AE9.3A)&#39;</span>, <span class="stringliteral">&quot;Residual: (&quot;</span>, f(1), <span class="stringliteral">&quot;, &quot;</span>, f(2), <span class="stringliteral">&quot;)&quot;</span></div><div class="line"><span class="keyword">contains</span></div><div class="line">    <span class="comment">! Define the routine containing the equations to solve.  The equations are:</span></div><div class="line">    <span class="comment">! x**2 + y**2 = 34</span></div><div class="line">    <span class="comment">! x**2 - 2 * y**2 = 7</span></div><div class="line"><span class="keyword">    subroutine </span>fcns(x, f)</div><div class="line">        <span class="keywordtype">real(real64)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x</div><div class="line">        <span class="keywordtype">real(real64)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:)</span> :: f</div><div class="line">        f(1) = x(1)**2 + x(2)**2 - 34.0d0</div><div class="line">        f(2) = x(1)**2 - 2.0d0 * x(2)**2 - 7.0d0</div><div class="line"><span class="keyword">    end subroutine</span></div><div class="line"><span class="keyword">end program</span></div></div><!-- fragment --> The above program produces the following output. <div class="fragment"><div class="line">Solution: (5.00000, 3.00000)</div><div class="line">Residual: (0.000E+00, 0.000E+00)</div></div><!-- fragment --> </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__core_8f90_source.html#l00339">339</a> of file <a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a>.</p>
</div><h2 class="groupheader">Member Function/Subroutine Documentation</h2>
<a id="a44c03a753473e7cc38776bf2005e1eb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44c03a753473e7cc38776bf2005e1eb8">&#9670;&nbsp;</a></span>fcn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_core::vecfcn_helper::fcn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Executes the routine containing the system of equations to solve. No action is taken if the pointer to the subroutine has not been defined. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">subroutine </span>fcn(class(vecfcn_helper) this, real(real64) x(:), real(real64) f(:))</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__core_1_1vecfcn__helper.html" title="Defines a type capable of encapsulating a system of nonlinear equations of the form: F(X) = 0...">vecfcn_helper</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>An N-element array containing the independent variables. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">f</td><td>An M-element array that, on output, contains the values of the M functions. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="nonlin__core_8f90_source.html#l00522">522</a> of file <a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a>.</p>

</div>
</div>
<a id="ab7d7b04b2705a59abf9f3533f65b9982"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7d7b04b2705a59abf9f3533f65b9982">&#9670;&nbsp;</a></span>get_equation_count()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_core::vecfcn_helper::get_equation_count </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the number of equations in this system. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">pure</span> <span class="keywordtype">integer(int32)</span> get_equation_count(<span class="keywordtype">class</span>(vecfcn_helper) this)</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__core_1_1vecfcn__helper.html" title="Defines a type capable of encapsulating a system of nonlinear equations of the form: F(X) = 0...">vecfcn_helper</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function count. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__core_8f90_source.html#l00567">567</a> of file <a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a>.</p>

</div>
</div>
<a id="ab9531f2873b46cdbfd446a911cc285fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9531f2873b46cdbfd446a911cc285fc">&#9670;&nbsp;</a></span>get_variable_count()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_core::vecfcn_helper::get_variable_count </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the number of variables in this system. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">pure</span> <span class="keywordtype">integer(int32)</span> get_variable_count(<span class="keywordtype">class</span>(vecfcn_helper) this)</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__core_1_1vecfcn__helper.html" title="Defines a type capable of encapsulating a system of nonlinear equations of the form: F(X) = 0...">vecfcn_helper</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of variables. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__core_8f90_source.html#l00577">577</a> of file <a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a>.</p>

</div>
</div>
<a id="ae5a78dc12bfaca9c6ee6a129611f6fae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5a78dc12bfaca9c6ee6a129611f6fae">&#9670;&nbsp;</a></span>is_fcn_defined()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_core::vecfcn_helper::is_fcn_defined </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests if the pointer to the subroutine containing the system of equations to solve has been assigned. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">pure logical </span><span class="keyword">function </span>is_fcn_defined(class(vecfcn_helper) this)</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__core_1_1vecfcn__helper.html" title="Defines a type capable of encapsulating a system of nonlinear equations of the form: F(X) = 0...">vecfcn_helper</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the pointer has been assigned; else, false. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__core_8f90_source.html#l00497">497</a> of file <a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a>.</p>

</div>
</div>
<a id="a95d28720ced834b78276792bc388ae3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95d28720ced834b78276792bc388ae3b">&#9670;&nbsp;</a></span>is_jacobian_defined()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_core::vecfcn_helper::is_jacobian_defined </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests if the pointer to the subroutine containing the system of equations to solve has been assigned. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">pure logical </span><span class="keyword">function </span>is_jacobian_defined(class(vecfcn_helper) this)</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__core_1_1vecfcn__helper.html" title="Defines a type capable of encapsulating a system of nonlinear equations of the form: F(X) = 0...">vecfcn_helper</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the pointer has been assigned; else, false. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__core_8f90_source.html#l00508">508</a> of file <a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a>.</p>

</div>
</div>
<a id="abb314c2501d0e7a1c973999c204abf8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb314c2501d0e7a1c973999c204abf8a">&#9670;&nbsp;</a></span>jacobian()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_core::vecfcn_helper::jacobian </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Executes the routine containing the Jacobian matrix if supplied. If not supplied, the Jacobian is computed via finite differences. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">subroutine </span>jacobian(class(vecfcn_helper) this real(real64) x(:), &amp;</div><div class="line"> <span class="keywordtype">real(real64)</span> jac(:), <span class="keywordtype">optional</span> <span class="keywordtype">real(real64)</span> fv(:), &amp;</div><div class="line"> <span class="keywordtype">optional</span> <span class="keywordtype">real(real64)</span> work(:), <span class="keywordtype">optional</span> <span class="keywordtype">integer(int32)</span> lwork, &amp;</div><div class="line"> <span class="keywordtype">optional</span> <span class="keywordtype">integer(int32)</span> err)</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__core_1_1vecfcn__helper.html" title="Defines a type capable of encapsulating a system of nonlinear equations of the form: F(X) = 0...">vecfcn_helper</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>An N-element array containing the independent variabls defining the point about which the derivatives will be calculated. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">jac</td><td>An M-by-N matrix where, on output, the Jacobian will be written. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fv</td><td>An optional M-element array containing the function values at <code>x</code>. If not supplied, the function values are computed at <code>x</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">work</td><td>An optional input, that if provided, prevents any local memory allocation. If not provided, the memory required is allocated within. If provided, the length of the array must be at least <code>olwork</code>. Notice, a workspace array is only utilized if the user does not provide a routine for computing the Jacobian. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">olwork</td><td>An optional output used to determine workspace size. If supplied, the routine determines the optimal size for <code>work</code>, and returns without performing any actual calculations. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional integer output that can be used to determine error status. If not used, and an error is encountered, the routine simply returns silently. If used, the following error codes identify error status:<ul>
<li>0: No error has occurred.</li>
<li>n: A positive integer denoting the index of an invalid input.</li>
<li>-1: Indicates internal memory allocation failed. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="nonlin__core_8f90_source.html#l00557">557</a> of file <a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a>.</p>

</div>
</div>
<a id="a41b867ae18398e8c7de44c6dc5b32aed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41b867ae18398e8c7de44c6dc5b32aed">&#9670;&nbsp;</a></span>set_fcn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_core::vecfcn_helper::set_fcn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Establishes a pointer to the routine containing the system of equations to solve. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">subroutine </span>set_fcn(class(vecfcn_helper) this, procedure(vecfcn) pointer fcn, integer(int32) nfcn, integer(int32) nvar)</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__core_1_1vecfcn__helper.html" title="Defines a type capable of encapsulating a system of nonlinear equations of the form: F(X) = 0...">vecfcn_helper</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fcn</td><td>The function pointer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nfcn</td><td>The number of functions. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nvar</td><td>The number of variables.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Example</dt><dd>The following example illustrates how to define the function to solve. Newton's method is being utilized via the newton_solver type. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span>iso_fortran_env</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__core.html">nonlin_core</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__solve.html">nonlin_solve</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Local Variables</span></div><div class="line">    <span class="keywordtype">type</span>(vecfcn_helper) :: obj</div><div class="line">    <span class="keywordtype">procedure</span>(vecfcn), <span class="keywordtype">pointer</span> :: fcn</div><div class="line">    <span class="keywordtype">type</span>(newton_solver) :: solver</div><div class="line">    <span class="keywordtype">real(real64)</span> :: x(2), f(2)</div><div class="line"></div><div class="line">    <span class="comment">! Assign a pointer to the subroutine containing the equations to solve</span></div><div class="line">    fcn =&gt; fcns</div><div class="line">    <span class="keyword">call </span>obj%set_fcn(fcn, 2, 2) <span class="comment">! There are 2 equations with 2 unknowns</span></div><div class="line"></div><div class="line">    <span class="comment">! Define an initial guess</span></div><div class="line">    x = 1.0d0 <span class="comment">! Equivalent to x = [1.0d0, 1.0d0]</span></div><div class="line"></div><div class="line">    <span class="comment">! Solve the system of equations</span></div><div class="line">    <span class="keyword">call </span>solver%solve(obj, x, f)</div><div class="line"></div><div class="line">    <span class="comment">! Display the output</span></div><div class="line">    print <span class="stringliteral">&#39;(AF7.5AF7.5A)&#39;</span>, <span class="stringliteral">&quot;Solution: (&quot;</span>, x(1), <span class="stringliteral">&quot;, &quot;</span>, x(2), <span class="stringliteral">&quot;)&quot;</span></div><div class="line">    print <span class="stringliteral">&#39;(AE9.3AE9.3A)&#39;</span>, <span class="stringliteral">&quot;Residual: (&quot;</span>, f(1), <span class="stringliteral">&quot;, &quot;</span>, f(2), <span class="stringliteral">&quot;)&quot;</span></div><div class="line"><span class="keyword">contains</span></div><div class="line">    <span class="comment">! Define the routine containing the equations to solve.  The equations are:</span></div><div class="line">    <span class="comment">! x**2 + y**2 = 34</span></div><div class="line">    <span class="comment">! x**2 - 2 * y**2 = 7</span></div><div class="line"><span class="keyword">    subroutine </span>fcns(x, f)</div><div class="line">        <span class="keywordtype">real(real64)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x</div><div class="line">        <span class="keywordtype">real(real64)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:)</span> :: f</div><div class="line">        f(1) = x(1)**2 + x(2)**2 - 34.0d0</div><div class="line">        f(2) = x(1)**2 - 2.0d0 * x(2)**2 - 7.0d0</div><div class="line"><span class="keyword">    end subroutine</span></div><div class="line"><span class="keyword">end program</span></div></div><!-- fragment --> The above program produces the following output. <div class="fragment"><div class="line">Solution: (5.00000, 3.00000)</div><div class="line">Residual: (0.000E+00, 0.000E+00)</div></div><!-- fragment --> </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__core_8f90_source.html#l00410">410</a> of file <a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a>.</p>

</div>
</div>
<a id="a28ad419ee7fd8d7f0529587d4a1bfc78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28ad419ee7fd8d7f0529587d4a1bfc78">&#9670;&nbsp;</a></span>set_jacobian()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_core::vecfcn_helper::set_jacobian </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Establishes a pointer to the routine for computing the Jacobian matrix of the system of equations. If no routine is defined, the Jacobian matrix will be computed numerically (this is the default state). </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">subroutine </span>set_jacobian(class(vecfcn_helper) this, procedure(jacobianfcn) pointer jac)</div></div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__core_1_1vecfcn__helper.html" title="Defines a type capable of encapsulating a system of nonlinear equations of the form: F(X) = 0...">vecfcn_helper</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jac</td><td>The function pointer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Example</dt><dd>The following example utilizes Newton's method to solve a system of 2 equations and 2 unknowns with a user-defined Jacobian. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span>iso_fortran_env</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__core.html">nonlin_core</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacenonlin__solve.html">nonlin_solve</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Local Variables</span></div><div class="line">    <span class="keywordtype">type</span>(vecfcn_helper) :: obj</div><div class="line">    <span class="keywordtype">procedure</span>(vecfcn), <span class="keywordtype">pointer</span> :: fcn</div><div class="line">    <span class="keywordtype">procedure</span>(jacobianfcn), <span class="keywordtype">pointer</span> :: jac</div><div class="line">    <span class="keywordtype">type</span>(newton_solver) :: solver</div><div class="line">    <span class="keywordtype">real(real64)</span> :: x(2), f(2)</div><div class="line"></div><div class="line">    <span class="comment">! Assign the function and Jacobian routines</span></div><div class="line">    fcn =&gt; fcns</div><div class="line">    jac =&gt; fcnjac</div><div class="line">    <span class="keyword">call </span>obj%set_fcn(fcn, 2, 2)</div><div class="line">    <span class="keyword">call </span>obj%set_jacobian(jac)</div><div class="line"></div><div class="line">    <span class="comment">! Define an initial guess</span></div><div class="line">    x = 1.0d0 <span class="comment">! Equivalent to x = [1.0d0, 1.0d0]</span></div><div class="line"></div><div class="line">    <span class="comment">! Solve the system of equations</span></div><div class="line">    <span class="keyword">call </span>solver%solve(obj, x, f)</div><div class="line"></div><div class="line">    <span class="comment">! Display the output</span></div><div class="line">    print <span class="stringliteral">&#39;(AF7.5AF7.5A)&#39;</span>, <span class="stringliteral">&quot;Solution: (&quot;</span>, x(1), <span class="stringliteral">&quot;, &quot;</span>, x(2), <span class="stringliteral">&quot;)&quot;</span></div><div class="line">    print <span class="stringliteral">&#39;(AE9.3AE9.3A)&#39;</span>, <span class="stringliteral">&quot;Residual: (&quot;</span>, f(1), <span class="stringliteral">&quot;, &quot;</span>, f(2), <span class="stringliteral">&quot;)&quot;</span></div><div class="line"><span class="keyword">contains</span></div><div class="line">    <span class="comment">! The system of equations (source: https://www.mathworks.com/help/optim/ug/fsolve.html)</span></div><div class="line">    <span class="comment">! 2 * x1 - x2 = exp(-x1)</span></div><div class="line">    <span class="comment">! -x1 + 2 * x2 = exp(-x2)</span></div><div class="line"><span class="keyword">    subroutine </span>fcns(x, f)</div><div class="line">        <span class="keywordtype">real(real64)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x</div><div class="line">        <span class="keywordtype">real(real64)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:)</span> :: f</div><div class="line">        f(1) = 2.0d0 * x(1) - x(2) - exp(-x(1))</div><div class="line">        f(2) = -x(1) + 2.0d0 * x(2) - exp(-x(2))</div><div class="line"><span class="keyword">    end subroutine</span></div><div class="line"></div><div class="line">    <span class="comment">! The Jacobian matrix:</span></div><div class="line">    <span class="comment">!     | exp(-x1) + 2          -1     |</span></div><div class="line">    <span class="comment">! J = |                              |</span></div><div class="line">    <span class="comment">!     |     -1          exp(-x2) + 2 |</span></div><div class="line"><span class="keyword">    subroutine </span>fcnjac(x, jac)</div><div class="line">        <span class="keywordtype">real(real64)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x</div><div class="line">        <span class="keywordtype">real(real64)</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:,:)</span> :: jac</div><div class="line">        jac(1,1) = exp(-x(1)) + 2.0d0</div><div class="line">        jac(2,1) = -1.0d0</div><div class="line">        jac(1,2) = -1.0d0</div><div class="line">        jac(2,2) = exp(-x(2)) + 2.0d0</div><div class="line"><span class="keyword">    end subroutine</span></div><div class="line"><span class="keyword">end program</span></div></div><!-- fragment --> The above program produces the following output. <div class="fragment"><div class="line">Solution: (0.56714, 0.56714)</div><div class="line">Residual: (-.693E-08, -.683E-08)</div></div><!-- fragment --> </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__core_8f90_source.html#l00486">486</a> of file <a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a>.</p>

</div>
</div>
<hr/>The documentation for this type was generated from the following file:<ul>
<li>D:/Projects/Code/nonlin/src/<a class="el" href="nonlin__core_8f90_source.html">nonlin_core.f90</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacenonlin__core.html">nonlin_core</a></li><li class="navelem"><a class="el" href="structnonlin__core_1_1vecfcn__helper.html">vecfcn_helper</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
