<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>nonlin: nonlin_least_squares::least_squares_solver Type Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">nonlin<span id="projectnumber">&#160;1.5.2</span>
   </div>
   <div id="projectbrief">A library that provides routines to compute the solutions to systems of nonlinear equations.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('structnonlin__least__squares_1_1least__squares__solver.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="structnonlin__least__squares_1_1least__squares__solver-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">nonlin_least_squares::least_squares_solver Type Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Defines a Levenberg-Marquardt based solver for unconstrained least-squares problems.  
 <a href="#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for nonlin_least_squares::least_squares_solver:</div>
<div class="dyncontent">
 <div class="center">
  <img src="structnonlin__least__squares_1_1least__squares__solver.png" usemap="#nonlin_5Fleast_5Fsquares::least_5Fsquares_5Fsolver_map" alt=""/>
  <map id="nonlin_5Fleast_5Fsquares::least_5Fsquares_5Fsolver_map" name="nonlin_5Fleast_5Fsquares::least_5Fsquares_5Fsolver_map">
<area href="structnonlin__core_1_1equation__solver.html" title="A base class for various solvers of nonlinear systems of equations." alt="nonlin_core::equation_solver" shape="rect" coords="0,0,255,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae34aa91f20783f4d1d9eea96474a4959" id="r_ae34aa91f20783f4d1d9eea96474a4959"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae34aa91f20783f4d1d9eea96474a4959">get_step_scaling_factor</a> (this)</td></tr>
<tr class="memdesc:ae34aa91f20783f4d1d9eea96474a4959"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a factor used to scale the bounds on the initial step.  <br /></td></tr>
<tr class="separator:ae34aa91f20783f4d1d9eea96474a4959"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a743d2df9144306349c1064c0b6c3d9cf" id="r_a743d2df9144306349c1064c0b6c3d9cf"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a743d2df9144306349c1064c0b6c3d9cf">set_step_scaling_factor</a> (this, x)</td></tr>
<tr class="memdesc:a743d2df9144306349c1064c0b6c3d9cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets a factor used to scale the bounds on the initial step.  <br /></td></tr>
<tr class="separator:a743d2df9144306349c1064c0b6c3d9cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba99c3d8d178a0b2a2e1e1655b8719c5" id="r_aba99c3d8d178a0b2a2e1e1655b8719c5"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aba99c3d8d178a0b2a2e1e1655b8719c5">solve</a> (this, fcn, x, fvec, ib, err)</td></tr>
<tr class="memdesc:aba99c3d8d178a0b2a2e1e1655b8719c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves the system of equations.  <br /></td></tr>
<tr class="separator:aba99c3d8d178a0b2a2e1e1655b8719c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_structnonlin__core_1_1equation__solver"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_structnonlin__core_1_1equation__solver')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="structnonlin__core_1_1equation__solver.html">nonlin_core::equation_solver</a></td></tr>
<tr class="memitem:aecbcf5840e3f9fbc0671f21415a3e4fa inherit pub_methods_structnonlin__core_1_1equation__solver" id="r_aecbcf5840e3f9fbc0671f21415a3e4fa"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__solver.html#aecbcf5840e3f9fbc0671f21415a3e4fa">get_max_fcn_evals</a> es_get_max_eval</td></tr>
<tr class="memdesc:aecbcf5840e3f9fbc0671f21415a3e4fa inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the maximum number of function evaluations allowed during a single solve.  <br /></td></tr>
<tr class="separator:aecbcf5840e3f9fbc0671f21415a3e4fa inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96afbc02c4a66b5b5e22dba082bfcf0c inherit pub_methods_structnonlin__core_1_1equation__solver" id="r_a96afbc02c4a66b5b5e22dba082bfcf0c"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__solver.html#a96afbc02c4a66b5b5e22dba082bfcf0c">set_max_fcn_evals</a> es_set_max_eval</td></tr>
<tr class="memdesc:a96afbc02c4a66b5b5e22dba082bfcf0c inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the maximum number of function evaluations allowed during a single solve.  <br /></td></tr>
<tr class="separator:a96afbc02c4a66b5b5e22dba082bfcf0c inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1ae5ae835c498f966c6c1714777c1de inherit pub_methods_structnonlin__core_1_1equation__solver" id="r_ab1ae5ae835c498f966c6c1714777c1de"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__solver.html#ab1ae5ae835c498f966c6c1714777c1de">get_fcn_tolerance</a> es_get_fcn_tol</td></tr>
<tr class="memdesc:ab1ae5ae835c498f966c6c1714777c1de inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the convergence on function value tolerance.  <br /></td></tr>
<tr class="separator:ab1ae5ae835c498f966c6c1714777c1de inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81a1e1ddce356258203815100a3b39f6 inherit pub_methods_structnonlin__core_1_1equation__solver" id="r_a81a1e1ddce356258203815100a3b39f6"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__solver.html#a81a1e1ddce356258203815100a3b39f6">set_fcn_tolerance</a> es_set_fcn_tol</td></tr>
<tr class="memdesc:a81a1e1ddce356258203815100a3b39f6 inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the convergence on function value tolerance.  <br /></td></tr>
<tr class="separator:a81a1e1ddce356258203815100a3b39f6 inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8055a214708189d8bdb636722d43923b inherit pub_methods_structnonlin__core_1_1equation__solver" id="r_a8055a214708189d8bdb636722d43923b"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__solver.html#a8055a214708189d8bdb636722d43923b">get_var_tolerance</a> es_get_var_tol</td></tr>
<tr class="memdesc:a8055a214708189d8bdb636722d43923b inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the convergence on change in variable tolerance.  <br /></td></tr>
<tr class="separator:a8055a214708189d8bdb636722d43923b inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a168e48dd8c70e9cfd3a319a88621c663 inherit pub_methods_structnonlin__core_1_1equation__solver" id="r_a168e48dd8c70e9cfd3a319a88621c663"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__solver.html#a168e48dd8c70e9cfd3a319a88621c663">set_var_tolerance</a> es_set_var_tol</td></tr>
<tr class="memdesc:a168e48dd8c70e9cfd3a319a88621c663 inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the convergence on change in variable tolerance.  <br /></td></tr>
<tr class="separator:a168e48dd8c70e9cfd3a319a88621c663 inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bda14deb10b9ba69e6a6581c09de275 inherit pub_methods_structnonlin__core_1_1equation__solver" id="r_a6bda14deb10b9ba69e6a6581c09de275"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__solver.html#a6bda14deb10b9ba69e6a6581c09de275">get_gradient_tolerance</a> es_get_grad_tol</td></tr>
<tr class="memdesc:a6bda14deb10b9ba69e6a6581c09de275 inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the convergence on slope of the gradient vector tolerance.  <br /></td></tr>
<tr class="separator:a6bda14deb10b9ba69e6a6581c09de275 inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3751f027788d9cbe1407f74b8758e2f5 inherit pub_methods_structnonlin__core_1_1equation__solver" id="r_a3751f027788d9cbe1407f74b8758e2f5"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__solver.html#a3751f027788d9cbe1407f74b8758e2f5">set_gradient_tolerance</a> es_set_grad_tol</td></tr>
<tr class="memdesc:a3751f027788d9cbe1407f74b8758e2f5 inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the convergence on slope of the gradient vector tolerance.  <br /></td></tr>
<tr class="separator:a3751f027788d9cbe1407f74b8758e2f5 inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec6eea1206218b711cdcc00c3a7b28bb inherit pub_methods_structnonlin__core_1_1equation__solver" id="r_aec6eea1206218b711cdcc00c3a7b28bb"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__solver.html#aec6eea1206218b711cdcc00c3a7b28bb">get_print_status</a> es_get_print_status</td></tr>
<tr class="memdesc:aec6eea1206218b711cdcc00c3a7b28bb inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a logical value determining if iteration status should be printed.  <br /></td></tr>
<tr class="separator:aec6eea1206218b711cdcc00c3a7b28bb inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4db2b8812cbd531f0d49ad3e7001a7b inherit pub_methods_structnonlin__core_1_1equation__solver" id="r_af4db2b8812cbd531f0d49ad3e7001a7b"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__solver.html#af4db2b8812cbd531f0d49ad3e7001a7b">set_print_status</a> es_set_print_status</td></tr>
<tr class="memdesc:af4db2b8812cbd531f0d49ad3e7001a7b inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets a logical value determining if iteration status should be printed.  <br /></td></tr>
<tr class="separator:af4db2b8812cbd531f0d49ad3e7001a7b inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a561d6b3e998fd0a12c8bdfa8f7feb6d8 inherit pub_methods_structnonlin__core_1_1equation__solver" id="r_a561d6b3e998fd0a12c8bdfa8f7feb6d8"><td class="memItemLeft" align="right" valign="top">procedure(<a class="el" href="interfacenonlin__core_1_1nonlin__solver.html">nonlin_solver</a>), deferred, pass, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__solver.html#a561d6b3e998fd0a12c8bdfa8f7feb6d8">solve</a> <a class="el" href="interfacenonlin__core_1_1nonlin__solver.html">nonlin_solver</a></td></tr>
<tr class="memdesc:a561d6b3e998fd0a12c8bdfa8f7feb6d8 inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves the system of equations.  <br /></td></tr>
<tr class="separator:a561d6b3e998fd0a12c8bdfa8f7feb6d8 inherit pub_methods_structnonlin__core_1_1equation__solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a5808c315224ce879db756f284e9de26d" id="r_a5808c315224ce879db756f284e9de26d"><td class="memItemLeft" align="right" valign="top">real(real64)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5808c315224ce879db756f284e9de26d">m_factor</a> = 100.0d0</td></tr>
<tr class="memdesc:a5808c315224ce879db756f284e9de26d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initial step bounding factor.  <br /></td></tr>
<tr class="separator:a5808c315224ce879db756f284e9de26d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_attribs_structnonlin__core_1_1equation__solver"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_attribs_structnonlin__core_1_1equation__solver')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="structnonlin__core_1_1equation__solver.html">nonlin_core::equation_solver</a></td></tr>
<tr class="memitem:ad2db6e98fec5ac9de636310d41036fae inherit pub_attribs_structnonlin__core_1_1equation__solver" id="r_ad2db6e98fec5ac9de636310d41036fae"><td class="memItemLeft" align="right" valign="top">real(real64)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__solver.html#ad2db6e98fec5ac9de636310d41036fae">m_fcntol</a> = 1.0d-8</td></tr>
<tr class="memdesc:ad2db6e98fec5ac9de636310d41036fae inherit pub_attribs_structnonlin__core_1_1equation__solver"><td class="mdescLeft">&#160;</td><td class="mdescRight">The convergence criteria on function values.  <br /></td></tr>
<tr class="separator:ad2db6e98fec5ac9de636310d41036fae inherit pub_attribs_structnonlin__core_1_1equation__solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af02d0e834603736a0235f18c77cf12d2 inherit pub_attribs_structnonlin__core_1_1equation__solver" id="r_af02d0e834603736a0235f18c77cf12d2"><td class="memItemLeft" align="right" valign="top">real(real64)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__solver.html#af02d0e834603736a0235f18c77cf12d2">m_xtol</a> = 1.0d-12</td></tr>
<tr class="memdesc:af02d0e834603736a0235f18c77cf12d2 inherit pub_attribs_structnonlin__core_1_1equation__solver"><td class="mdescLeft">&#160;</td><td class="mdescRight">The convergence criteria on change in variable values.  <br /></td></tr>
<tr class="separator:af02d0e834603736a0235f18c77cf12d2 inherit pub_attribs_structnonlin__core_1_1equation__solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af77ceddf83ca6f4b86715452175cf03c inherit pub_attribs_structnonlin__core_1_1equation__solver" id="r_af77ceddf83ca6f4b86715452175cf03c"><td class="memItemLeft" align="right" valign="top">real(real64)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__solver.html#af77ceddf83ca6f4b86715452175cf03c">m_gtol</a> = 1.0d-12</td></tr>
<tr class="memdesc:af77ceddf83ca6f4b86715452175cf03c inherit pub_attribs_structnonlin__core_1_1equation__solver"><td class="mdescLeft">&#160;</td><td class="mdescRight">The convergence criteria for the slope of the gradient vector.  <br /></td></tr>
<tr class="separator:af77ceddf83ca6f4b86715452175cf03c inherit pub_attribs_structnonlin__core_1_1equation__solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af45b53871eb687d267fa622135062ff6 inherit pub_attribs_structnonlin__core_1_1equation__solver" id="r_af45b53871eb687d267fa622135062ff6"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__solver.html#af45b53871eb687d267fa622135062ff6">m_printstatus</a> = .false.</td></tr>
<tr class="memdesc:af45b53871eb687d267fa622135062ff6 inherit pub_attribs_structnonlin__core_1_1equation__solver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to true to print iteration status; else, false.  <br /></td></tr>
<tr class="separator:af45b53871eb687d267fa622135062ff6 inherit pub_attribs_structnonlin__core_1_1equation__solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Defines a Levenberg-Marquardt based solver for unconstrained least-squares problems. </p>

<p class="definition">Definition at line <a class="el" href="nonlin__least__squares_8f90_source.html#l00021">21</a> of file <a class="el" href="nonlin__least__squares_8f90_source.html">nonlin_least_squares.f90</a>.</p>
</div><h2 class="groupheader">Member Function/Subroutine Documentation</h2>
<a id="ae34aa91f20783f4d1d9eea96474a4959" name="ae34aa91f20783f4d1d9eea96474a4959"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae34aa91f20783f4d1d9eea96474a4959">&#9670;&#160;</a></span>get_step_scaling_factor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_least_squares::least_squares_solver::get_step_scaling_factor </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__least__squares_1_1least__squares__solver.html">least_squares_solver</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>this</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets a factor used to scale the bounds on the initial step. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__least__squares_1_1least__squares__solver.html" title="Defines a Levenberg-Marquardt based solver for unconstrained least-squares problems.">least_squares_solver</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The factor.</dd></dl>
<dl class="section user"><dt>Remarks</dt><dd>This factor is used to set the bounds on the initial step such that the initial step is bounded as the product of the factor with the Euclidean norm of the vector resulting from multiplication of the diagonal scaling matrix and the solution estimate. If zero, the factor itself is used. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__least__squares_8f90_source.html#l00027">27</a> of file <a class="el" href="nonlin__least__squares_8f90_source.html">nonlin_least_squares.f90</a>.</p>

</div>
</div>
<a id="a743d2df9144306349c1064c0b6c3d9cf" name="a743d2df9144306349c1064c0b6c3d9cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a743d2df9144306349c1064c0b6c3d9cf">&#9670;&#160;</a></span>set_step_scaling_factor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_least_squares::least_squares_solver::set_step_scaling_factor </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__least__squares_1_1least__squares__solver.html">least_squares_solver</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>this</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets a factor used to scale the bounds on the initial step. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__least__squares_1_1least__squares__solver.html" title="Defines a Levenberg-Marquardt based solver for unconstrained least-squares problems.">least_squares_solver</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The factor. Notice, the factor is limited to the interval [0.1, 100].</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Remarks</dt><dd>This factor is used to set the bounds on the initial step such that the initial step is bounded as the product of the factor with the Euclidean norm of the vector resulting from multiplication of the diagonal scaling matrix and the solution estimate. If zero, the factor itself is used. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__least__squares_8f90_source.html#l00029">29</a> of file <a class="el" href="nonlin__least__squares_8f90_source.html">nonlin_least_squares.f90</a>.</p>

</div>
</div>
<a id="aba99c3d8d178a0b2a2e1e1655b8719c5" name="aba99c3d8d178a0b2a2e1e1655b8719c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba99c3d8d178a0b2a2e1e1655b8719c5">&#9670;&#160;</a></span>solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_least_squares::least_squares_solver::solve </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__least__squares_1_1least__squares__solver.html">least_squares_solver</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>this</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structnonlin__core_1_1vecfcn__helper.html">vecfcn_helper</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>fcn</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>x</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out)</td>          <td class="paramname"><span class="paramname"><em>fvec</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structnonlin__core_1_1iteration__behavior.html">iteration_behavior</a>), optional</td>          <td class="paramname"><span class="paramname"><em>ib</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(errors), intent(inout), optional, target</td>          <td class="paramname"><span class="paramname"><em>err</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solves the system of equations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__least__squares_1_1least__squares__solver.html" title="Defines a Levenberg-Marquardt based solver for unconstrained least-squares problems.">least_squares_solver</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fcn</td><td>The vecfcn_helper object containing the equations to solve. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>On input, an M-element array containing an initial estimate to the solution. On output, the updated solution estimate. M is the number of variables. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fvec</td><td>An N-element array that, on output, will contain the values of each equation as evaluated at the variable values given in <code>x</code>. N is the number of equations. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ib</td><td>An optional output, that if provided, allows the caller to obtain iteration performance statistics. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional errors-based object that if provided can be used to retrieve information relating to any errors encountered during execution. If not provided, a default implementation of the errors class is used internally to provide error handling. Possible errors and warning messages that may be encountered are as follows.<ul>
<li>NL_INVALID_OPERATION_ERROR: Occurs if no equations have been defined.</li>
<li>NL_INVALID_INPUT_ERROR: Occurs if the number of equations is less than than the number of variables.</li>
<li>NL_ARRAY_SIZE_ERROR: Occurs if any of the input arrays are not sized correctly.</li>
<li>NL_CONVERGENCE_ERROR: Occurs if the line search cannot converge within the allowed number of iterations.</li>
<li>NL_OUT_OF_MEMORY_ERROR: Occurs if there is insufficient memory available.</li>
<li>NL_TOLERANCE_TOO_SMALL_ERROR: Occurs if the requested tolerance is to small to be practical for the problem at hand.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Remarks</dt><dd>This routines is based upon the MINPACK routine LMDIF.</dd></dl>
<dl class="section user"><dt>Example 1</dt><dd>The following code provides an example of how to solve a system of N equations of N unknonwns using the Levenberg-Marquardt method. <div class="fragment"><div class="line"><span class="keyword">program</span> main</div>
<div class="line">    <span class="keywordtype">use </span><a class="code hl_namespace" href="namespacenonlin__core.html">nonlin_core</a>, <span class="keywordtype">only</span> : <a class="code hl_interface" href="interfacenonlin__core_1_1vecfcn.html">vecfcn</a>, <a class="code hl_struct" href="structnonlin__core_1_1vecfcn__helper.html">vecfcn_helper</a></div>
<div class="line">    <span class="keywordtype">use </span><a class="code hl_namespace" href="namespacenonlin__least__squares.html">nonlin_least_squares</a>, <span class="keywordtype">only</span> : <a class="code hl_struct" href="structnonlin__least__squares_1_1least__squares__solver.html">least_squares_solver</a></div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">type</span>(vecfcn_helper) :: obj</div>
<div class="line">    <span class="keywordtype">procedure</span>(vecfcn), <span class="keywordtype">pointer</span> :: fcn</div>
<div class="line">    <span class="keywordtype">type</span>(least_squares_solver) :: solver</div>
<div class="line"><span class="keywordtype">    real</span>(real64) :: x(2), f(2)</div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Set the initial conditions to [1, 1]</span></div>
<div class="line">    x = 1.0d0</div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Define the function</span></div>
<div class="line">    fcn =&gt; fcn1</div>
<div class="line">    <span class="keyword">call </span>obj%set_fcn(fcn, 2, 2)</div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Solve the system of equations.  The solution overwrites X</span></div>
<div class="line">    <span class="keyword">call </span>solver%solve(obj, x, f)</div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Print the output and the residual:</span></div>
<div class="line">    print <span class="stringliteral">&#39;(AF5.3AF5.3A)&#39;</span>, <span class="stringliteral">&quot;The solution: (&quot;</span>, x(1), <span class="stringliteral">&quot;, &quot;</span>, x(2), <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line">    print <span class="stringliteral">&#39;(AE8.3AE8.3A)&#39;</span>, <span class="stringliteral">&quot;The residual: (&quot;</span>, f(1), <span class="stringliteral">&quot;, &quot;</span>, f(2), <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><span class="keyword">contains</span></div>
<div class="line">    <span class="comment">! System of Equations:</span></div>
<div class="line">    <span class="comment">!</span></div>
<div class="line">    <span class="comment">! x**2 + y**2 = 34</span></div>
<div class="line">    <span class="comment">! x**2 - 2 * y**2 = 7</span></div>
<div class="line">    <span class="comment">!</span></div>
<div class="line">    <span class="comment">! Solution:</span></div>
<div class="line">    <span class="comment">! x = +/-5</span></div>
<div class="line">    <span class="comment">! y = +/-3</span></div>
<div class="line">    <span class="keyword">subroutine </span>fcn1(x, f)</div>
<div class="line"><span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x</div>
<div class="line"><span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:)</span> :: f</div>
<div class="line">        f(1) = x(1)**2 + x(2)**2 - 34.0d0</div>
<div class="line">        f(2) = x(1)**2 - 2.0d0 * x(2)**2 - 7.0d0</div>
<div class="line">    <span class="keyword">end subroutine</span></div>
<div class="line"><span class="keyword">end program</span></div>
<div class="ttc" id="ainterfacenonlin__core_1_1vecfcn_html"><div class="ttname"><a href="interfacenonlin__core_1_1vecfcn.html">nonlin_core::vecfcn</a></div><div class="ttdoc">Describes an M-element vector-valued function of N-variables.</div><div class="ttdef"><b>Definition</b> <a href="nonlin__core_8f90_source.html#l00209">nonlin_core.f90:209</a></div></div>
<div class="ttc" id="anamespacenonlin__core_html"><div class="ttname"><a href="namespacenonlin__core.html">nonlin_core</a></div><div class="ttdoc">nonlin_core</div><div class="ttdef"><b>Definition</b> <a href="nonlin__core_8f90_source.html#l00167">nonlin_core.f90:167</a></div></div>
<div class="ttc" id="anamespacenonlin__least__squares_html"><div class="ttname"><a href="namespacenonlin__least__squares.html">nonlin_least_squares</a></div><div class="ttdoc">nonlin_least_squares</div><div class="ttdef"><b>Definition</b> <a href="nonlin__least__squares_8f90_source.html#l00007">nonlin_least_squares.f90:7</a></div></div>
<div class="ttc" id="astructnonlin__core_1_1vecfcn__helper_html"><div class="ttname"><a href="structnonlin__core_1_1vecfcn__helper.html">nonlin_core::vecfcn_helper</a></div><div class="ttdoc">Defines a type capable of encapsulating a system of nonlinear equations of the form: F(X) = 0....</div><div class="ttdef"><b>Definition</b> <a href="nonlin__core_8f90_source.html#l00339">nonlin_core.f90:339</a></div></div>
<div class="ttc" id="astructnonlin__least__squares_1_1least__squares__solver_html"><div class="ttname"><a href="structnonlin__least__squares_1_1least__squares__solver.html">nonlin_least_squares::least_squares_solver</a></div><div class="ttdoc">Defines a Levenberg-Marquardt based solver for unconstrained least-squares problems.</div><div class="ttdef"><b>Definition</b> <a href="nonlin__least__squares_8f90_source.html#l00021">nonlin_least_squares.f90:21</a></div></div>
</div><!-- fragment --> The above program returns the following results. <div class="fragment"><div class="line">The solution: (5.000, 3.000)</div>
<div class="line">The residual: (.000E+00, .000E+00)</div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt>Example 2</dt><dd><div class="fragment"><div class="line"><span class="keyword">program</span> example</div>
<div class="line">    <span class="keywordtype">use </span><a class="code hl_namespace" href="namespacenonlin__core.html">nonlin_core</a>, <span class="keywordtype">only</span> : <a class="code hl_struct" href="structnonlin__core_1_1vecfcn__helper.html">vecfcn_helper</a>, <a class="code hl_interface" href="interfacenonlin__core_1_1vecfcn.html">vecfcn</a></div>
<div class="line">    <span class="keywordtype">use </span><a class="code hl_namespace" href="namespacenonlin__least__squares.html">nonlin_least_squares</a>, <span class="keywordtype">only</span> : <a class="code hl_struct" href="structnonlin__least__squares_1_1least__squares__solver.html">least_squares_solver</a></div>
<div class="line">    <span class="keywordtype">implicit none</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Local Variables</span></div>
<div class="line">    <span class="keywordtype">type</span>(vecfcn_helper) :: obj</div>
<div class="line">    <span class="keywordtype">procedure</span>(vecfcn), <span class="keywordtype">pointer</span> :: fcn</div>
<div class="line">    <span class="keywordtype">type</span>(least_squares_solver) :: solver</div>
<div class="line"><span class="keywordtype">    real</span>(real64) :: x(4), f(21) <span class="comment">! There are 4 coefficients and 21 data points</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Locate the routine containing the equations to solve</span></div>
<div class="line">    fcn =&gt; fcns</div>
<div class="line">    <span class="keyword">call </span>obj%set_fcn(fcn, 21, 4)</div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Define an initial guess</span></div>
<div class="line">    x = 1.0d0 <span class="comment">! Equivalent to x = [1.0d0, 1.0d0, 1.0d0, 1.0d0]</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Solve</span></div>
<div class="line">    <span class="keyword">call </span>solver%solve(obj, x, f)</div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Display the output</span></div>
<div class="line">    print <span class="stringliteral">&quot;(AF12.8)&quot;</span>, <span class="stringliteral">&quot;c1: &quot;</span>, x(1)</div>
<div class="line">    print <span class="stringliteral">&quot;(AF12.8)&quot;</span>, <span class="stringliteral">&quot;c2: &quot;</span>, x(2)</div>
<div class="line">    print <span class="stringliteral">&quot;(AF12.8)&quot;</span>, <span class="stringliteral">&quot;c3: &quot;</span>, x(3)</div>
<div class="line">    print <span class="stringliteral">&quot;(AF12.8)&quot;</span>, <span class="stringliteral">&quot;c4: &quot;</span>, x(4)</div>
<div class="line">    print <span class="stringliteral">&quot;(AF9.5)&quot;</span>, <span class="stringliteral">&quot;Max Residual: &quot;</span>, maxval(abs(f))</div>
<div class="line"> </div>
<div class="line"><span class="keyword">contains</span></div>
<div class="line">    <span class="comment">! The function containing the data to fit</span></div>
<div class="line">    <span class="keyword">subroutine </span>fcns(x, f)</div>
<div class="line">        <span class="comment">! Arguments</span></div>
<div class="line"><span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x  <span class="comment">! Contains the coefficients</span></div>
<div class="line"><span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:)</span> :: f</div>
<div class="line"> </div>
<div class="line">        <span class="comment">! Local Variables</span></div>
<div class="line"><span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(21)</span> :: xp, yp</div>
<div class="line"> </div>
<div class="line">        <span class="comment">! Data to fit (21 data points)</span></div>
<div class="line">        xp = [0.0d0, 0.1d0, 0.2d0, 0.3d0, 0.4d0, 0.5d0, 0.6d0, 0.7d0, 0.8d0, &amp;</div>
<div class="line">            0.9d0, 1.0d0, 1.1d0, 1.2d0, 1.3d0, 1.4d0, 1.5d0, 1.6d0, 1.7d0, &amp;</div>
<div class="line">            1.8d0, 1.9d0, 2.0d0]</div>
<div class="line">        yp = [1.216737514d0, 1.250032542d0, 1.305579195d0, 1.040182335d0, &amp;</div>
<div class="line">            1.751867738d0, 1.109716707d0, 2.018141531d0, 1.992418729d0, &amp;</div>
<div class="line">            1.807916923d0, 2.078806005d0, 2.698801324d0, 2.644662712d0, &amp;</div>
<div class="line">            3.412756702d0, 4.406137221d0, 4.567156645d0, 4.999550779d0, &amp;</div>
<div class="line">            5.652854194d0, 6.784320119d0, 8.307936836d0, 8.395126494d0, &amp;</div>
<div class="line">            10.30252404d0]</div>
<div class="line"> </div>
<div class="line">        <span class="comment">! We&#39;ll apply a cubic polynomial model to this data:</span></div>
<div class="line">        <span class="comment">! y = c1 * x**3 + c2 * x**2 + c3 * x + c4</span></div>
<div class="line">        f = x(1) * xp**3 + x(2) * xp**2 + x(3) * xp + x(4) - yp</div>
<div class="line"> </div>
<div class="line">        <span class="comment">! For reference, the data was generated by adding random errors to</span></div>
<div class="line">        <span class="comment">! the following polynomial: y = x**3 - 0.3 * x**2 + 1.2 * x + 0.3</span></div>
<div class="line">    <span class="keyword">end subroutine</span></div>
<div class="line"><span class="keyword">end program</span></div>
</div><!-- fragment --> The above program returns the following results. <div class="fragment"><div class="line">c1:   1.06476276</div>
<div class="line">c2:  -0.12232029</div>
<div class="line">c3:   0.44661345</div>
<div class="line">c4:   1.18661422</div>
<div class="line">Max Residual:   0.50636</div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt>See Also</dt><dd><ul>
<li><a href="https://en.wikipedia.org/wiki/Levenberg%E2%80%93Marquardt_algorithm">Wikipedia</a></li>
<li><a href="https://en.wikipedia.org/wiki/MINPACK">MINPACK (Wikipedia)</a> </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__least__squares_8f90_source.html#l00031">31</a> of file <a class="el" href="nonlin__least__squares_8f90_source.html">nonlin_least_squares.f90</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a5808c315224ce879db756f284e9de26d" name="a5808c315224ce879db756f284e9de26d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5808c315224ce879db756f284e9de26d">&#9670;&#160;</a></span>m_factor</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) nonlin_least_squares::least_squares_solver::m_factor = 100.0d0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initial step bounding factor. </p>

<p class="definition">Definition at line <a class="el" href="nonlin__least__squares_8f90_source.html#l00024">24</a> of file <a class="el" href="nonlin__least__squares_8f90_source.html">nonlin_least_squares.f90</a>.</p>

</div>
</div>
<hr/>The documentation for this type was generated from the following file:<ul>
<li>D:/Code/nonlin/src/<a class="el" href="nonlin__least__squares_8f90_source.html">nonlin_least_squares.f90</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacenonlin__least__squares.html">nonlin_least_squares</a></li><li class="navelem"><a class="el" href="structnonlin__least__squares_1_1least__squares__solver.html">least_squares_solver</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
