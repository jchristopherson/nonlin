<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>nonlin: nonlin_optimize::nelder_mead Type Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">nonlin<span id="projectnumber">&#160;1.5.2</span>
   </div>
   <div id="projectbrief">A library that provides routines to compute the solutions to systems of nonlinear equations.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('structnonlin__optimize_1_1nelder__mead.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="structnonlin__optimize_1_1nelder__mead-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">nonlin_optimize::nelder_mead Type Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Defines a solver based upon Nelder and Mead's simplex algorithm for minimization of functions of multiple variables.  
 <a href="#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for nonlin_optimize::nelder_mead:</div>
<div class="dyncontent">
 <div class="center">
  <img src="structnonlin__optimize_1_1nelder__mead.png" usemap="#nonlin_5Foptimize::nelder_5Fmead_map" alt=""/>
  <map id="nonlin_5Foptimize::nelder_5Fmead_map" name="nonlin_5Foptimize::nelder_5Fmead_map">
<area href="structnonlin__core_1_1equation__optimizer.html" title="A base class for optimization of an equation of multiple variables." alt="nonlin_core::equation_optimizer" shape="rect" coords="0,0,189,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae2cb405466b076d6e8930e19f17770a6" id="r_ae2cb405466b076d6e8930e19f17770a6"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae2cb405466b076d6e8930e19f17770a6">solve</a> nm_solve</td></tr>
<tr class="memdesc:ae2cb405466b076d6e8930e19f17770a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utilizes the Nelder-Mead simplex method for finding a minimum value of the specified function.  <br /></td></tr>
<tr class="separator:ae2cb405466b076d6e8930e19f17770a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac338594615244d127ce5573cc92106b2" id="r_ac338594615244d127ce5573cc92106b2"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac338594615244d127ce5573cc92106b2">get_simplex</a> nm_get_simplex</td></tr>
<tr class="memdesc:ac338594615244d127ce5573cc92106b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets an N-by-(N+1) matrix containing the current simplex.  <br /></td></tr>
<tr class="separator:ac338594615244d127ce5573cc92106b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba6ad14185a1e71fe6a79651693c252c" id="r_aba6ad14185a1e71fe6a79651693c252c"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aba6ad14185a1e71fe6a79651693c252c">set_simplex</a> nm_set_simplex</td></tr>
<tr class="memdesc:aba6ad14185a1e71fe6a79651693c252c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets an N-by-(N+1) matrix as the current simplex. Notice, if this matrix is different in size from the problem dimensionallity, the Nelder-Mead routine will replace it with an appropriately sized matrix.  <br /></td></tr>
<tr class="separator:aba6ad14185a1e71fe6a79651693c252c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb56f03d3b63c3d87d5bb49ecc7c44fe" id="r_acb56f03d3b63c3d87d5bb49ecc7c44fe"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acb56f03d3b63c3d87d5bb49ecc7c44fe">get_initial_size</a> nm_get_size</td></tr>
<tr class="memdesc:acb56f03d3b63c3d87d5bb49ecc7c44fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the size of the initial simplex that will be utilized by the Nelder-Mead algorithm in the event that the user does not supply a simplex geometry, or if the user supplies an invalid simplex geometry.  <br /></td></tr>
<tr class="separator:acb56f03d3b63c3d87d5bb49ecc7c44fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0eeaf857198fc99c64ce303230515c00" id="r_a0eeaf857198fc99c64ce303230515c00"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0eeaf857198fc99c64ce303230515c00">set_initial_size</a> nm_set_size</td></tr>
<tr class="memdesc:a0eeaf857198fc99c64ce303230515c00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the size of the initial simplex that will be utilized by the Nelder-Mead algorithm in the event that the user does not supply a simplex geometry, or if the user supplies an invalid simplex geometry.  <br /></td></tr>
<tr class="separator:a0eeaf857198fc99c64ce303230515c00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_structnonlin__core_1_1equation__optimizer"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_structnonlin__core_1_1equation__optimizer')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="structnonlin__core_1_1equation__optimizer.html">nonlin_core::equation_optimizer</a></td></tr>
<tr class="memitem:a2b75bb748a6ab5c9ae8c3def005e4966 inherit pub_methods_structnonlin__core_1_1equation__optimizer" id="r_a2b75bb748a6ab5c9ae8c3def005e4966"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__optimizer.html#a2b75bb748a6ab5c9ae8c3def005e4966">get_max_fcn_evals</a> oe_get_max_eval</td></tr>
<tr class="memdesc:a2b75bb748a6ab5c9ae8c3def005e4966 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the maximum number of function evaluations allowed.  <br /></td></tr>
<tr class="separator:a2b75bb748a6ab5c9ae8c3def005e4966 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2f6c4652b91bb4162c646ab18f12c0b inherit pub_methods_structnonlin__core_1_1equation__optimizer" id="r_ae2f6c4652b91bb4162c646ab18f12c0b"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__optimizer.html#ae2f6c4652b91bb4162c646ab18f12c0b">set_max_fcn_evals</a> oe_set_max_eval</td></tr>
<tr class="memdesc:ae2f6c4652b91bb4162c646ab18f12c0b inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the maximum number of function evaluations allowed.  <br /></td></tr>
<tr class="separator:ae2f6c4652b91bb4162c646ab18f12c0b inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45cf69598ac1e32679a2b234e255082d inherit pub_methods_structnonlin__core_1_1equation__optimizer" id="r_a45cf69598ac1e32679a2b234e255082d"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__optimizer.html#a45cf69598ac1e32679a2b234e255082d">get_tolerance</a> oe_get_tol</td></tr>
<tr class="memdesc:a45cf69598ac1e32679a2b234e255082d inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the tolerance on convergence.  <br /></td></tr>
<tr class="separator:a45cf69598ac1e32679a2b234e255082d inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ba9e21d557871d193ec9b2c15aa5dab inherit pub_methods_structnonlin__core_1_1equation__optimizer" id="r_a9ba9e21d557871d193ec9b2c15aa5dab"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__optimizer.html#a9ba9e21d557871d193ec9b2c15aa5dab">set_tolerance</a> oe_set_tol</td></tr>
<tr class="memdesc:a9ba9e21d557871d193ec9b2c15aa5dab inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the tolerance on convergence.  <br /></td></tr>
<tr class="separator:a9ba9e21d557871d193ec9b2c15aa5dab inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af954502dd381c86e74e9c16e8825f3e0 inherit pub_methods_structnonlin__core_1_1equation__optimizer" id="r_af954502dd381c86e74e9c16e8825f3e0"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__optimizer.html#af954502dd381c86e74e9c16e8825f3e0">get_print_status</a> oe_get_print_status</td></tr>
<tr class="memdesc:af954502dd381c86e74e9c16e8825f3e0 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a logical value determining if iteration status should be printed.  <br /></td></tr>
<tr class="separator:af954502dd381c86e74e9c16e8825f3e0 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a746222cf61b8e55477eeb368abc45401 inherit pub_methods_structnonlin__core_1_1equation__optimizer" id="r_a746222cf61b8e55477eeb368abc45401"><td class="memItemLeft" align="right" valign="top">procedure, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__optimizer.html#a746222cf61b8e55477eeb368abc45401">set_print_status</a> oe_set_print_status</td></tr>
<tr class="memdesc:a746222cf61b8e55477eeb368abc45401 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets a logical value determining if iteration status should be printed.  <br /></td></tr>
<tr class="separator:a746222cf61b8e55477eeb368abc45401 inherit pub_methods_structnonlin__core_1_1equation__optimizer"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:aa05ef531dcb5279fcc00f66ddaa36555" id="r_aa05ef531dcb5279fcc00f66ddaa36555"><td class="memItemLeft" align="right" valign="top">real(real64)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa05ef531dcb5279fcc00f66ddaa36555">m_initsize</a> = 1.0d0</td></tr>
<tr class="memdesc:aa05ef531dcb5279fcc00f66ddaa36555"><td class="mdescLeft">&#160;</td><td class="mdescRight">A scaling parameter used to define the size of the simplex in each coordinate direction.  <br /></td></tr>
<tr class="separator:aa05ef531dcb5279fcc00f66ddaa36555"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_attribs_structnonlin__core_1_1equation__optimizer"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_attribs_structnonlin__core_1_1equation__optimizer')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="structnonlin__core_1_1equation__optimizer.html">nonlin_core::equation_optimizer</a></td></tr>
<tr class="memitem:a1a889674b291e7d94c94e00d1523b952 inherit pub_attribs_structnonlin__core_1_1equation__optimizer" id="r_a1a889674b291e7d94c94e00d1523b952"><td class="memItemLeft" align="right" valign="top">real(real64)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__optimizer.html#a1a889674b291e7d94c94e00d1523b952">m_tol</a> = 1.0d-12</td></tr>
<tr class="memdesc:a1a889674b291e7d94c94e00d1523b952 inherit pub_attribs_structnonlin__core_1_1equation__optimizer"><td class="mdescLeft">&#160;</td><td class="mdescRight">The error tolerance used to determine convergence.  <br /></td></tr>
<tr class="separator:a1a889674b291e7d94c94e00d1523b952 inherit pub_attribs_structnonlin__core_1_1equation__optimizer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a418a8ea0832d48a51bb1ab6bb984bb50 inherit pub_attribs_structnonlin__core_1_1equation__optimizer" id="r_a418a8ea0832d48a51bb1ab6bb984bb50"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__core_1_1equation__optimizer.html#a418a8ea0832d48a51bb1ab6bb984bb50">m_printstatus</a> = .false.</td></tr>
<tr class="memdesc:a418a8ea0832d48a51bb1ab6bb984bb50 inherit pub_attribs_structnonlin__core_1_1equation__optimizer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to true to print iteration status; else, false.  <br /></td></tr>
<tr class="separator:a418a8ea0832d48a51bb1ab6bb984bb50 inherit pub_attribs_structnonlin__core_1_1equation__optimizer"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ab96ece8cdad3a5a80f2c05216b15072c" id="r_ab96ece8cdad3a5a80f2c05216b15072c"><td class="memItemLeft" align="right" valign="top">procedure, private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab96ece8cdad3a5a80f2c05216b15072c">extrapolate</a> nm_extrapolate</td></tr>
<tr class="memdesc:ab96ece8cdad3a5a80f2c05216b15072c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates by the specified factor through the simplex across from the largest point. If the extrapolation results in a better estimate, the current high point is replaced with the new estimate.  <br /></td></tr>
<tr class="separator:ab96ece8cdad3a5a80f2c05216b15072c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:af5d3d067795864bdd038f794a08231f2" id="r_af5d3d067795864bdd038f794a08231f2"><td class="memItemLeft" align="right" valign="top">real(real64), dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af5d3d067795864bdd038f794a08231f2">m_simplex</a></td></tr>
<tr class="memdesc:af5d3d067795864bdd038f794a08231f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The simplex vertices.  <br /></td></tr>
<tr class="separator:af5d3d067795864bdd038f794a08231f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Defines a solver based upon Nelder and Mead's simplex algorithm for minimization of functions of multiple variables. </p>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00032">32</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>
</div><h2 class="groupheader">Member Function/Subroutine Documentation</h2>
<a id="ab96ece8cdad3a5a80f2c05216b15072c" name="ab96ece8cdad3a5a80f2c05216b15072c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab96ece8cdad3a5a80f2c05216b15072c">&#9670;&#160;</a></span>extrapolate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">procedure, private nonlin_optimize::nelder_mead::extrapolate</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extrapolates by the specified factor through the simplex across from the largest point. If the extrapolation results in a better estimate, the current high point is replaced with the new estimate. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">real(real64) </span><span class="keyword">function </span>extrapolate(class(nelder_mead) this, class(fcnnvar_helper) fcn, real(real64) y(:), real(real64) pcent(:), integer(int32) ihi, real(real64) fac, integer(int32) neval, real(real64) work(:))</div>
</div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1nelder__mead.html" title="Defines a solver based upon Nelder and Mead&#39;s simplex algorithm for minimization of functions of mult...">nelder_mead</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fcn</td><td>The function to evaluate. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">y</td><td>An array containing the function values at each vertex. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pcent</td><td>An array containing the centroid of vertex position information. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ihi</td><td>The index of the largest magnitude vertex. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">neval</td><td>The number of function evaluations. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">work</td><td>An N-element workspace array where N is the number of dimensions of the problem. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The new function estimate. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00213">213</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="acb56f03d3b63c3d87d5bb49ecc7c44fe" name="acb56f03d3b63c3d87d5bb49ecc7c44fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb56f03d3b63c3d87d5bb49ecc7c44fe">&#9670;&#160;</a></span>get_initial_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_optimize::nelder_mead::get_initial_size</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the size of the initial simplex that will be utilized by the Nelder-Mead algorithm in the event that the user does not supply a simplex geometry, or if the user supplies an invalid simplex geometry. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">pure</span> real(real64) get_initial_size(<span class="keywordtype">class</span>(nelder_mead) this)</div>
</div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1nelder__mead.html" title="Defines a solver based upon Nelder and Mead&#39;s simplex algorithm for minimization of functions of mult...">nelder_mead</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size of the simplex (length of an edge). </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00175">175</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="ac338594615244d127ce5573cc92106b2" name="ac338594615244d127ce5573cc92106b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac338594615244d127ce5573cc92106b2">&#9670;&#160;</a></span>get_simplex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_optimize::nelder_mead::get_simplex</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets an N-by-(N+1) matrix containing the current simplex. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">pure</span> real(real64)(:,:) <span class="keyword">function </span>get_simplex(class(nelder_mead) this)</div>
</div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1nelder__mead.html" title="Defines a solver based upon Nelder and Mead&#39;s simplex algorithm for minimization of functions of mult...">nelder_mead</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The N-by-(N+1) matrix containing the simplex. Each vertex of the simplex is stored as its own column of this matrix. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00144">144</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="a0eeaf857198fc99c64ce303230515c00" name="a0eeaf857198fc99c64ce303230515c00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0eeaf857198fc99c64ce303230515c00">&#9670;&#160;</a></span>set_initial_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_optimize::nelder_mead::set_initial_size</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the size of the initial simplex that will be utilized by the Nelder-Mead algorithm in the event that the user does not supply a simplex geometry, or if the user supplies an invalid simplex geometry. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">subroutine </span>set_initial_size(class(nelder_mead) this, real(real64) x)</div>
</div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1nelder__mead.html" title="Defines a solver based upon Nelder and Mead&#39;s simplex algorithm for minimization of functions of mult...">nelder_mead</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The size of the simplex (length of an edge).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>example</dt><dd><div class="fragment"></div><!-- fragment --> </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00192">192</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="aba6ad14185a1e71fe6a79651693c252c" name="aba6ad14185a1e71fe6a79651693c252c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba6ad14185a1e71fe6a79651693c252c">&#9670;&#160;</a></span>set_simplex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_optimize::nelder_mead::set_simplex</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets an N-by-(N+1) matrix as the current simplex. Notice, if this matrix is different in size from the problem dimensionallity, the Nelder-Mead routine will replace it with an appropriately sized matrix. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">subroutine </span>set_simplex(class(nelder_mead) this, real(real64) x(:,:))</div>
</div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1nelder__mead.html" title="Defines a solver based upon Nelder and Mead&#39;s simplex algorithm for minimization of functions of mult...">nelder_mead</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The simplex matrix. Each column of the matrix must contain the coordinates of each vertex of the simplex.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>example</dt><dd><div class="fragment"></div><!-- fragment --> </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00162">162</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="ae2cb405466b076d6e8930e19f17770a6" name="ae2cb405466b076d6e8930e19f17770a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2cb405466b076d6e8930e19f17770a6">&#9670;&#160;</a></span>solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">procedure, public nonlin_optimize::nelder_mead::solve</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utilizes the Nelder-Mead simplex method for finding a minimum value of the specified function. </p>
<dl class="section user"><dt>Syntax</dt><dd><div class="fragment"><div class="line"><span class="keyword">subroutine </span>solve(class(nelder_mead) this, class(fcnnvar_helper) fcn, real(real64) x(:), real(real64) fout, optional type(iteration_behavior) ib, optional class(errors) err)</div>
</div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__optimize_1_1nelder__mead.html" title="Defines a solver based upon Nelder and Mead&#39;s simplex algorithm for minimization of functions of mult...">nelder_mead</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fcn</td><td>The fcnnvar_helper object containing the equation to optimize. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>On input, the initial guess at the optimal point. On output, the updated optimal point estimate. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fout</td><td>An optional output, that if provided, returns the value of the function at <code>x</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ib</td><td>An optional output, that if provided, allows the caller to obtain iteration performance statistics. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional errors-based object that if provided can be used to retrieve information relating to any errors encountered during execution. If not provided, a default implementation of the errors class is used internally to provide error handling. Possible errors and warning messages that may be encountered are as follows.<ul>
<li>NL_INVALID_OPERATION_ERROR: Occurs if no equations have been defined.</li>
<li>NL_INVALID_INPUT_ERROR: Occurs if <code>x</code> is not appropriately sized for the problem as defined in <code>fcn</code>.</li>
<li>NL_OUT_OF_MEMORY_ERROR: Occurs if there is insufficient memory available.</li>
<li>NL_CONVERGENCE_ERROR: Occurs if the algorithm cannot converge within the allowed number of iterations.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Example</dt><dd>The following example illustrates how to find the minimum of Rosenbrock's function using this Nelder-Mead solver. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div>
<div class="line">    <span class="keywordtype">use </span><a class="code hl_namespace" href="namespacenonlin__optimize.html">nonlin_optimize</a>, <span class="keywordtype">only</span> : <a class="code hl_struct" href="structnonlin__optimize_1_1nelder__mead.html">nelder_mead</a></div>
<div class="line">    <span class="keywordtype">use </span><a class="code hl_namespace" href="namespacenonlin__core.html">nonlin_core</a>, <span class="keywordtype">only</span> : <a class="code hl_interface" href="interfacenonlin__core_1_1fcnnvar.html">fcnnvar</a>, <a class="code hl_struct" href="structnonlin__core_1_1fcnnvar__helper.html">fcnnvar_helper</a>, <a class="code hl_struct" href="structnonlin__core_1_1iteration__behavior.html">iteration_behavior</a></div>
<div class="line">    <span class="keywordtype">implicit none</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Local Variables</span></div>
<div class="line">    <span class="keywordtype">type</span>(nelder_mead) :: solver</div>
<div class="line">    <span class="keywordtype">type</span>(fcnnvar_helper) :: obj</div>
<div class="line">    <span class="keywordtype">procedure</span>(fcnnvar), <span class="keywordtype">pointer</span> :: fcn</div>
<div class="line"><span class="keywordtype">    real</span>(real64) :: x(2), fout</div>
<div class="line">    <span class="keywordtype">type</span>(iteration_behavior) :: ib</div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Initialization</span></div>
<div class="line">    fcn =&gt; rosenbrock</div>
<div class="line">    <span class="keyword">call </span>obj%set_fcn(fcn, 2)</div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Define an initial guess - the solution is (1, 1)</span></div>
<div class="line">    <span class="keyword">call </span>random_number(x)</div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Call the solver</span></div>
<div class="line">    <span class="keyword">call </span>solver%solve(obj, x, fout, ib)</div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Display the output</span></div>
<div class="line">    print <span class="stringliteral">&#39;(AF8.5AF8.5A)&#39;</span>, <span class="stringliteral">&quot;Rosenbrock Minimum: (&quot;</span>, x(1), <span class="stringliteral">&quot;, &quot;</span>, x(2), <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line">    print <span class="stringliteral">&#39;(AE9.3)&#39;</span>, <span class="stringliteral">&quot;Function Value: &quot;</span>, fout</div>
<div class="line">    print <span class="stringliteral">&#39;(AI0)&#39;</span>, <span class="stringliteral">&quot;Iterations: &quot;</span>, ib%iter_count</div>
<div class="line">    print <span class="stringliteral">&#39;(AI0)&#39;</span>, <span class="stringliteral">&quot;Function Evaluations: &quot;</span>, ib%fcn_count</div>
<div class="line"><span class="keyword">contains</span></div>
<div class="line">    <span class="comment">! Rosenbrock&#39;s Function</span></div>
<div class="line">    <span class="keyword">function </span>rosenbrock(x) <span class="keyword">result</span>(f)</div>
<div class="line"><span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x</div>
<div class="line"><span class="keywordtype">        real</span>(real64) :: f</div>
<div class="line">        f = 1.0d2 * (x(2) - x(1)**2)**2 + (x(1) - 1.0d0)**2</div>
<div class="line">    <span class="keyword">end function</span></div>
<div class="line"><span class="keyword">end</span></div>
<div class="ttc" id="ainterfacenonlin__core_1_1fcnnvar_html"><div class="ttname"><a href="interfacenonlin__core_1_1fcnnvar.html">nonlin_core::fcnnvar</a></div><div class="ttdoc">Describes a function of N variables.</div><div class="ttdef"><b>Definition</b> <a href="nonlin__core_8f90_source.html#l00230">nonlin_core.f90:230</a></div></div>
<div class="ttc" id="anamespacenonlin__core_html"><div class="ttname"><a href="namespacenonlin__core.html">nonlin_core</a></div><div class="ttdoc">nonlin_core</div><div class="ttdef"><b>Definition</b> <a href="nonlin__core_8f90_source.html#l00167">nonlin_core.f90:167</a></div></div>
<div class="ttc" id="anamespacenonlin__optimize_html"><div class="ttname"><a href="namespacenonlin__optimize.html">nonlin_optimize</a></div><div class="ttdoc">nonlin_optimize</div><div class="ttdef"><b>Definition</b> <a href="nonlin__optimize_8f90_source.html#l00013">nonlin_optimize.f90:13</a></div></div>
<div class="ttc" id="astructnonlin__core_1_1fcnnvar__helper_html"><div class="ttname"><a href="structnonlin__core_1_1fcnnvar__helper.html">nonlin_core::fcnnvar_helper</a></div><div class="ttdoc">Defines a type capable of encapsulating an equation of N variables.</div><div class="ttdef"><b>Definition</b> <a href="nonlin__core_8f90_source.html#l00896">nonlin_core.f90:896</a></div></div>
<div class="ttc" id="astructnonlin__core_1_1iteration__behavior_html"><div class="ttname"><a href="structnonlin__core_1_1iteration__behavior.html">nonlin_core::iteration_behavior</a></div><div class="ttdoc">Defines a set of parameters that describe the behavior of the iteration process.</div><div class="ttdef"><b>Definition</b> <a href="nonlin__core_8f90_source.html#l00254">nonlin_core.f90:254</a></div></div>
<div class="ttc" id="astructnonlin__optimize_1_1nelder__mead_html"><div class="ttname"><a href="structnonlin__optimize_1_1nelder__mead.html">nonlin_optimize::nelder_mead</a></div><div class="ttdoc">Defines a solver based upon Nelder and Mead's simplex algorithm for minimization of functions of mult...</div><div class="ttdef"><b>Definition</b> <a href="nonlin__optimize_8f90_source.html#l00032">nonlin_optimize.f90:32</a></div></div>
</div><!-- fragment --> The above program yields the following output. <div class="fragment"><div class="line">Rosenbrock Minimum: ( 1.00000,  1.00000)</div>
<div class="line">Function Value: 0.264E-12</div>
<div class="line">Iterations: 59</div>
<div class="line">Function Evaluations: 112</div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt>Remarks</dt><dd>The implementation of the Nelder-Mead algorithm presented here is a slight modification of the original work of Nelder and Mead. The Numerical Recipes implementation is also quite similar. In fact, the Numerical Recipes section relating to reflection, contraction, etc. is leveraged for this implemetation.</dd></dl>
<dl class="section user"><dt>See Also</dt><dd><ul>
<li>Nelder, John A.; R. Mead (1965). "A simplex method for function
      minimization". Computer Journal. 7: 308–313.</li>
<li>[Gao, Fuchang, Han, Lixing (2010). "Implementing the Nelder-Mead
      simplex algorithm with adaptive parameters."] (<a href="http://www.webpages.uidaho.edu/~fuchang/res/ANMS.pdf">http://www.webpages.uidaho.edu/~fuchang/res/ANMS.pdf</a>)</li>
<li><a href="https://en.wikipedia.org/wiki/Nelder–Mead_method">Wikipedia</a></li>
<li><a href="http://numerical.recipes/">Numerical Recipes</a> </li>
</ul>
</dd></dl>

<p>Implements <a class="el" href="structnonlin__core_1_1equation__optimizer.html#a653661026df35795910cf85d2ed62c6b">nonlin_core::equation_optimizer</a>.</p>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00133">133</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aa05ef531dcb5279fcc00f66ddaa36555" name="aa05ef531dcb5279fcc00f66ddaa36555"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa05ef531dcb5279fcc00f66ddaa36555">&#9670;&#160;</a></span>m_initsize</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) nonlin_optimize::nelder_mead::m_initsize = 1.0d0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A scaling parameter used to define the size of the simplex in each coordinate direction. </p>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00038">38</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<a id="af5d3d067795864bdd038f794a08231f2" name="af5d3d067795864bdd038f794a08231f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5d3d067795864bdd038f794a08231f2">&#9670;&#160;</a></span>m_simplex</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(real64), dimension(:,:), allocatable nonlin_optimize::nelder_mead::m_simplex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The simplex vertices. </p>

<p class="definition">Definition at line <a class="el" href="nonlin__optimize_8f90_source.html#l00035">35</a> of file <a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a>.</p>

</div>
</div>
<hr/>The documentation for this type was generated from the following file:<ul>
<li>D:/Code/nonlin/src/<a class="el" href="nonlin__optimize_8f90_source.html">nonlin_optimize.f90</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacenonlin__optimize.html">nonlin_optimize</a></li><li class="navelem"><a class="el" href="structnonlin__optimize_1_1nelder__mead.html">nelder_mead</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
