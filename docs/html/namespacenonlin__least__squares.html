<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>nonlin: nonlin_least_squares Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">nonlin<span id="projectnumber">&#160;1.5.0</span>
   </div>
   <div id="projectbrief">A library that provides routines to compute the solutions to systems of nonlinear equations.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespacenonlin__least__squares.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">nonlin_least_squares Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p><b><a class="el" href="namespacenonlin__least__squares.html" title="nonlin_least_squares">nonlin_least_squares</a></b>  
<a href="namespacenonlin__least__squares.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnonlin__least__squares_1_1least__squares__solver.html">least_squares_solver</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines a Levenberg-Marquardt based solver for unconstrained least-squares problems.  <a href="structnonlin__least__squares_1_1least__squares__solver.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a1e0b514919f21f9226c5ed69eee4018b"><td class="memItemLeft" align="right" valign="top">pure real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__least__squares.html#a1e0b514919f21f9226c5ed69eee4018b">lss_get_factor</a> (this)</td></tr>
<tr class="memdesc:a1e0b514919f21f9226c5ed69eee4018b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a factor used to scale the bounds on the initial step.  <a href="namespacenonlin__least__squares.html#a1e0b514919f21f9226c5ed69eee4018b">More...</a><br /></td></tr>
<tr class="separator:a1e0b514919f21f9226c5ed69eee4018b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af93ae0c6697ce082b10c9577c17d35f2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__least__squares.html#af93ae0c6697ce082b10c9577c17d35f2">lss_set_factor</a> (this, x)</td></tr>
<tr class="memdesc:af93ae0c6697ce082b10c9577c17d35f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets a factor used to scale the bounds on the initial step.  <a href="namespacenonlin__least__squares.html#af93ae0c6697ce082b10c9577c17d35f2">More...</a><br /></td></tr>
<tr class="separator:af93ae0c6697ce082b10c9577c17d35f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a974515039f6a26d25f774604eeaef992"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__least__squares.html#a974515039f6a26d25f774604eeaef992">lss_solve</a> (this, fcn, x, fvec, ib, err)</td></tr>
<tr class="memdesc:a974515039f6a26d25f774604eeaef992"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the Levenberg-Marquardt method to solve the nonlinear least-squares problem.  <a href="namespacenonlin__least__squares.html#a974515039f6a26d25f774604eeaef992">More...</a><br /></td></tr>
<tr class="separator:a974515039f6a26d25f774604eeaef992"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff0b0333d5da3f2c6f9418faf9bed743"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__least__squares.html#aff0b0333d5da3f2c6f9418faf9bed743">lmpar</a> (r, ipvt, diag, qtb, delta, par, x, sdiag, wa1, wa2)</td></tr>
<tr class="memdesc:aff0b0333d5da3f2c6f9418faf9bed743"><td class="mdescLeft">&#160;</td><td class="mdescRight">Completes the solution of the Levenberg-Marquardt problem when provided with a QR factored form of the system Jacobian matrix. The form of the problem at this stage is J*X = B (J = Jacobian), and D*X = 0, where D is a diagonal matrix.  <a href="namespacenonlin__least__squares.html#aff0b0333d5da3f2c6f9418faf9bed743">More...</a><br /></td></tr>
<tr class="separator:aff0b0333d5da3f2c6f9418faf9bed743"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4e4f6036867660fa6ad45ee6000fd47"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__least__squares.html#ad4e4f6036867660fa6ad45ee6000fd47">lmfactor</a> (a, pivot, ipvt, rdiag, acnorm, wa)</td></tr>
<tr class="memdesc:ad4e4f6036867660fa6ad45ee6000fd47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the QR factorization of an M-by-N matrix.  <a href="namespacenonlin__least__squares.html#ad4e4f6036867660fa6ad45ee6000fd47">More...</a><br /></td></tr>
<tr class="separator:ad4e4f6036867660fa6ad45ee6000fd47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa04692a475a2845cd5f05e8798696483"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenonlin__least__squares.html#aa04692a475a2845cd5f05e8798696483">lmsolve</a> (r, ipvt, diag, qtb, x, sdiag, wa)</td></tr>
<tr class="memdesc:aa04692a475a2845cd5f05e8798696483"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves the QR factored system A*X = B, coupled with the diagonal system D*X = 0 in the least-squares sense.  <a href="namespacenonlin__least__squares.html#aa04692a475a2845cd5f05e8798696483">More...</a><br /></td></tr>
<tr class="separator:aa04692a475a2845cd5f05e8798696483"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p ><b><a class="el" href="namespacenonlin__least__squares.html" title="nonlin_least_squares">nonlin_least_squares</a></b> </p>
<dl class="section user"><dt>Purpose</dt><dd>To provide routines capable of solving the nonlinear least squares problem. </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ad4e4f6036867660fa6ad45ee6000fd47" name="ad4e4f6036867660fa6ad45ee6000fd47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4e4f6036867660fa6ad45ee6000fd47">&#9670;&#160;</a></span>lmfactor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine nonlin_least_squares::lmfactor </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>pivot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(int32), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>ipvt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>rdiag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>acnorm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>wa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the QR factorization of an M-by-N matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>On input, the M-by-N matrix to factor. On output, the strict upper triangular portion contains matrix R1 of the factorization, the lower trapezoidal portion contains the factored form of Q1, and the diagonal contains the corresponding elementary reflector. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pivot</td><td>Set to true to utilize column pivoting; else, set to false for no pivoting. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ipvt</td><td>An N-element array that is used to contain the pivot indices unless <code>pivot</code> is set to false. In such event, this array is unused. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rdiag</td><td>An N-element array used to store the diagonal elements of the R1 matrix. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">acnorm</td><td>An N-element array used to contain the norms of each column in the event column pivoting is used. If pivoting is not used, this array is unused. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">wa</td><td>An N-element workspace array.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Remarks</dt><dd>This routines is based upon the MINPACK routine QRFAC. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__least__squares_8f90_source.html#l00733">733</a> of file <a class="el" href="nonlin__least__squares_8f90_source.html">nonlin_least_squares.f90</a>.</p>

</div>
</div>
<a id="aff0b0333d5da3f2c6f9418faf9bed743" name="aff0b0333d5da3f2c6f9418faf9bed743"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff0b0333d5da3f2c6f9418faf9bed743">&#9670;&#160;</a></span>lmpar()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine nonlin_least_squares::lmpar </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(int32), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>ipvt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>qtb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(inout)&#160;</td>
          <td class="paramname"><em>par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>sdiag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>wa1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>wa2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Completes the solution of the Levenberg-Marquardt problem when provided with a QR factored form of the system Jacobian matrix. The form of the problem at this stage is J*X = B (J = Jacobian), and D*X = 0, where D is a diagonal matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">r</td><td>On input, the N-by-N upper triangular matrix R1 of the QR factorization. On output, the upper triangular portion is unaltered, but the strict lower triangle contains the strict upper triangle (transposed) of the matrix S. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipvt</td><td>An N-element array tracking the pivoting operations from the original QR factorization. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">diag</td><td>An N-element array containing the diagonal components of the matrix D. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qtb</td><td>An N-element array containing the first N elements of Q1**T * B. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delta</td><td>A positive input variable that specifies an upper bounds on the Euclidean norm of D*X. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">par</td><td>On input, the initial estimate of the Levenberg-Marquardt parameter. On output, the final estimate. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">x</td><td>The N-element array that is the solution of A*X = B, and of D*X = 0. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sdiag</td><td>An N-element array containing the diagonal elements of the matrix S. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">wa1</td><td>An N-element workspace array. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">wa2</td><td>An N-element workspace array.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Remarks</dt><dd>This routines is based upon the MINPACK routine LMPAR. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__least__squares_8f90_source.html#l00566">566</a> of file <a class="el" href="nonlin__least__squares_8f90_source.html">nonlin_least_squares.f90</a>.</p>

</div>
</div>
<a id="aa04692a475a2845cd5f05e8798696483" name="aa04692a475a2845cd5f05e8798696483"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa04692a475a2845cd5f05e8798696483">&#9670;&#160;</a></span>lmsolve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine nonlin_least_squares::lmsolve </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(int32), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>ipvt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>qtb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>sdiag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>wa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solves the QR factored system A*X = B, coupled with the diagonal system D*X = 0 in the least-squares sense. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">r</td><td>On input, the N-by-N upper triangular matrix R1 of the QR factorization. On output, the upper triangular portion is unaltered, but the strict lower triangle contains the strict upper triangle (transposed) of the matrix S. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipvt</td><td>An N-element array tracking the pivoting operations from the original QR factorization. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">diag</td><td>An N-element array containing the diagonal components of the matrix D. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qtb</td><td>An N-element array containing the first N elements of Q1**T * B. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">x</td><td>The N-element array that is the solution of A*X = B, and of D*X = 0. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sdiag</td><td>An N-element array containing the diagonal elements of the matrix S. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">wa</td><td>An N-element workspace array.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Remarks</dt><dd>This routines is based upon the MINPACK routine QRSOLV. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__least__squares_8f90_source.html#l00836">836</a> of file <a class="el" href="nonlin__least__squares_8f90_source.html">nonlin_least_squares.f90</a>.</p>

</div>
</div>
<a id="a1e0b514919f21f9226c5ed69eee4018b" name="a1e0b514919f21f9226c5ed69eee4018b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e0b514919f21f9226c5ed69eee4018b">&#9670;&#160;</a></span>lss_get_factor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure real(real64) function nonlin_least_squares::lss_get_factor </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__least__squares_1_1least__squares__solver.html">least_squares_solver</a>), intent(in)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets a factor used to scale the bounds on the initial step. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__least__squares_1_1least__squares__solver.html" title="Defines a Levenberg-Marquardt based solver for unconstrained least-squares problems.">least_squares_solver</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The factor.</dd></dl>
<dl class="section user"><dt>Remarks</dt><dd>This factor is used to set the bounds on the initial step such that the initial step is bounded as the product of the factor with the Euclidean norm of the vector resulting from multiplication of the diagonal scaling matrix and the solution estimate. If zero, the factor itself is used. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__least__squares_8f90_source.html#l00049">49</a> of file <a class="el" href="nonlin__least__squares_8f90_source.html">nonlin_least_squares.f90</a>.</p>

</div>
</div>
<a id="af93ae0c6697ce082b10c9577c17d35f2" name="af93ae0c6697ce082b10c9577c17d35f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af93ae0c6697ce082b10c9577c17d35f2">&#9670;&#160;</a></span>lss_set_factor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine nonlin_least_squares::lss_set_factor </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__least__squares_1_1least__squares__solver.html">least_squares_solver</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets a factor used to scale the bounds on the initial step. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__least__squares_1_1least__squares__solver.html" title="Defines a Levenberg-Marquardt based solver for unconstrained least-squares problems.">least_squares_solver</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>The factor. Notice, the factor is limited to the interval [0.1, 100].</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Remarks</dt><dd>This factor is used to set the bounds on the initial step such that the initial step is bounded as the product of the factor with the Euclidean norm of the vector resulting from multiplication of the diagonal scaling matrix and the solution estimate. If zero, the factor itself is used. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__least__squares_8f90_source.html#l00068">68</a> of file <a class="el" href="nonlin__least__squares_8f90_source.html">nonlin_least_squares.f90</a>.</p>

</div>
</div>
<a id="a974515039f6a26d25f774604eeaef992" name="a974515039f6a26d25f774604eeaef992"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a974515039f6a26d25f774604eeaef992">&#9670;&#160;</a></span>lss_solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine nonlin_least_squares::lss_solve </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structnonlin__least__squares_1_1least__squares__solver.html">least_squares_solver</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structnonlin__core_1_1vecfcn__helper.html">vecfcn_helper</a>), intent(in)&#160;</td>
          <td class="paramname"><em>fcn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>fvec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structnonlin__core_1_1iteration__behavior.html">iteration_behavior</a>), optional&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(errors), intent(inout), optional, target&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Applies the Levenberg-Marquardt method to solve the nonlinear least-squares problem. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>The <a class="el" href="structnonlin__least__squares_1_1least__squares__solver.html" title="Defines a Levenberg-Marquardt based solver for unconstrained least-squares problems.">least_squares_solver</a> object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fcn</td><td>The vecfcn_helper object containing the equations to solve. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>On input, an M-element array containing an initial estimate to the solution. On output, the updated solution estimate. M is the number of variables. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fvec</td><td>An N-element array that, on output, will contain the values of each equation as evaluated at the variable values given in <code>x</code>. N is the number of equations. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ib</td><td>An optional output, that if provided, allows the caller to obtain iteration performance statistics. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional errors-based object that if provided can be used to retrieve information relating to any errors encountered during execution. If not provided, a default implementation of the errors class is used internally to provide error handling. Possible errors and warning messages that may be encountered are as follows.<ul>
<li>NL_INVALID_OPERATION_ERROR: Occurs if no equations have been defined.</li>
<li>NL_INVALID_INPUT_ERROR: Occurs if the number of equations is less than than the number of variables.</li>
<li>NL_ARRAY_SIZE_ERROR: Occurs if any of the input arrays are not sized correctly.</li>
<li>NL_CONVERGENCE_ERROR: Occurs if the line search cannot converge within the allowed number of iterations.</li>
<li>NL_OUT_OF_MEMORY_ERROR: Occurs if there is insufficient memory available.</li>
<li>NL_TOLERANCE_TOO_SMALL_ERROR: Occurs if the requested tolerance is to small to be practical for the problem at hand.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Remarks</dt><dd>This routines is based upon the MINPACK routine LMDIF.</dd></dl>
<dl class="section user"><dt>Example 1</dt><dd>The following code provides an example of how to solve a system of N equations of N unknonwns using the Levenberg-Marquardt method. <div class="fragment"><div class="line"><span class="keyword">program</span> main</div>
<div class="line">    <span class="keywordtype">use </span><a class="code hl_namespace" href="namespacenonlin__core.html">nonlin_core</a>, <span class="keywordtype">only</span> : <a class="code hl_interface" href="interfacenonlin__core_1_1vecfcn.html">vecfcn</a>, <a class="code hl_struct" href="structnonlin__core_1_1vecfcn__helper.html">vecfcn_helper</a></div>
<div class="line">    <span class="keywordtype">use </span><a class="code hl_namespace" href="namespacenonlin__least__squares.html">nonlin_least_squares</a>, <span class="keywordtype">only</span> : <a class="code hl_struct" href="structnonlin__least__squares_1_1least__squares__solver.html">least_squares_solver</a></div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">type</span>(vecfcn_helper) :: obj</div>
<div class="line">    <span class="keywordtype">procedure</span>(vecfcn), <span class="keywordtype">pointer</span> :: fcn</div>
<div class="line">    <span class="keywordtype">type</span>(least_squares_solver) :: solver</div>
<div class="line"><span class="keywordtype">    real</span>(real64) :: x(2), f(2)</div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Set the initial conditions to [1, 1]</span></div>
<div class="line">    x = 1.0d0</div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Define the function</span></div>
<div class="line">    fcn =&gt; fcn1</div>
<div class="line">    <span class="keyword">call </span>obj%set_fcn(fcn, 2, 2)</div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Solve the system of equations.  The solution overwrites X</span></div>
<div class="line">    <span class="keyword">call </span>solver%solve(obj, x, f)</div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Print the output and the residual:</span></div>
<div class="line">    print <span class="stringliteral">&#39;(AF5.3AF5.3A)&#39;</span>, <span class="stringliteral">&quot;The solution: (&quot;</span>, x(1), <span class="stringliteral">&quot;, &quot;</span>, x(2), <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line">    print <span class="stringliteral">&#39;(AE8.3AE8.3A)&#39;</span>, <span class="stringliteral">&quot;The residual: (&quot;</span>, f(1), <span class="stringliteral">&quot;, &quot;</span>, f(2), <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><span class="keyword">contains</span></div>
<div class="line">    <span class="comment">! System of Equations:</span></div>
<div class="line">    <span class="comment">!</span></div>
<div class="line">    <span class="comment">! x**2 + y**2 = 34</span></div>
<div class="line">    <span class="comment">! x**2 - 2 * y**2 = 7</span></div>
<div class="line">    <span class="comment">!</span></div>
<div class="line">    <span class="comment">! Solution:</span></div>
<div class="line">    <span class="comment">! x = +/-5</span></div>
<div class="line">    <span class="comment">! y = +/-3</span></div>
<div class="line">    <span class="keyword">subroutine </span>fcn1(x, f)</div>
<div class="line"><span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x</div>
<div class="line"><span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:)</span> :: f</div>
<div class="line">        f(1) = x(1)**2 + x(2)**2 - 34.0d0</div>
<div class="line">        f(2) = x(1)**2 - 2.0d0 * x(2)**2 - 7.0d0</div>
<div class="line">    <span class="keyword">end subroutine</span></div>
<div class="line"><span class="keyword">end program</span></div>
<div class="ttc" id="ainterfacenonlin__core_1_1vecfcn_html"><div class="ttname"><a href="interfacenonlin__core_1_1vecfcn.html">nonlin_core::vecfcn</a></div><div class="ttdoc">Describes an M-element vector-valued function of N-variables.</div><div class="ttdef"><b>Definition:</b> <a href="nonlin__core_8f90_source.html#l00209">nonlin_core.f90:209</a></div></div>
<div class="ttc" id="anamespacenonlin__core_html"><div class="ttname"><a href="namespacenonlin__core.html">nonlin_core</a></div><div class="ttdoc">nonlin_core</div><div class="ttdef"><b>Definition:</b> <a href="nonlin__core_8f90_source.html#l00167">nonlin_core.f90:167</a></div></div>
<div class="ttc" id="anamespacenonlin__least__squares_html"><div class="ttname"><a href="namespacenonlin__least__squares.html">nonlin_least_squares</a></div><div class="ttdoc">nonlin_least_squares</div><div class="ttdef"><b>Definition:</b> <a href="nonlin__least__squares_8f90_source.html#l00007">nonlin_least_squares.f90:7</a></div></div>
<div class="ttc" id="astructnonlin__core_1_1vecfcn__helper_html"><div class="ttname"><a href="structnonlin__core_1_1vecfcn__helper.html">nonlin_core::vecfcn_helper</a></div><div class="ttdoc">Defines a type capable of encapsulating a system of nonlinear equations of the form: F(X) = 0....</div><div class="ttdef"><b>Definition:</b> <a href="nonlin__core_8f90_source.html#l00339">nonlin_core.f90:339</a></div></div>
<div class="ttc" id="astructnonlin__least__squares_1_1least__squares__solver_html"><div class="ttname"><a href="structnonlin__least__squares_1_1least__squares__solver.html">nonlin_least_squares::least_squares_solver</a></div><div class="ttdoc">Defines a Levenberg-Marquardt based solver for unconstrained least-squares problems.</div><div class="ttdef"><b>Definition:</b> <a href="nonlin__least__squares_8f90_source.html#l00021">nonlin_least_squares.f90:21</a></div></div>
</div><!-- fragment --> The above program returns the following results. <div class="fragment"><div class="line">The solution: (5.000, 3.000)</div>
<div class="line">The residual: (.000E+00, .000E+00)</div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt>Example 2</dt><dd><div class="fragment"><div class="line"><span class="keyword">program</span> example</div>
<div class="line">    <span class="keywordtype">use </span><a class="code hl_namespace" href="namespacenonlin__core.html">nonlin_core</a>, <span class="keywordtype">only</span> : <a class="code hl_struct" href="structnonlin__core_1_1vecfcn__helper.html">vecfcn_helper</a>, <a class="code hl_interface" href="interfacenonlin__core_1_1vecfcn.html">vecfcn</a></div>
<div class="line">    <span class="keywordtype">use </span><a class="code hl_namespace" href="namespacenonlin__least__squares.html">nonlin_least_squares</a>, <span class="keywordtype">only</span> : <a class="code hl_struct" href="structnonlin__least__squares_1_1least__squares__solver.html">least_squares_solver</a></div>
<div class="line">    <span class="keywordtype">implicit none</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Local Variables</span></div>
<div class="line">    <span class="keywordtype">type</span>(vecfcn_helper) :: obj</div>
<div class="line">    <span class="keywordtype">procedure</span>(vecfcn), <span class="keywordtype">pointer</span> :: fcn</div>
<div class="line">    <span class="keywordtype">type</span>(least_squares_solver) :: solver</div>
<div class="line"><span class="keywordtype">    real</span>(real64) :: x(4), f(21) <span class="comment">! There are 4 coefficients and 21 data points</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Locate the routine containing the equations to solve</span></div>
<div class="line">    fcn =&gt; fcns</div>
<div class="line">    <span class="keyword">call </span>obj%set_fcn(fcn, 21, 4)</div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Define an initial guess</span></div>
<div class="line">    x = 1.0d0 <span class="comment">! Equivalent to x = [1.0d0, 1.0d0, 1.0d0, 1.0d0]</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Solve</span></div>
<div class="line">    <span class="keyword">call </span>solver%solve(obj, x, f)</div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Display the output</span></div>
<div class="line">    print <span class="stringliteral">&quot;(AF12.8)&quot;</span>, <span class="stringliteral">&quot;c1: &quot;</span>, x(1)</div>
<div class="line">    print <span class="stringliteral">&quot;(AF12.8)&quot;</span>, <span class="stringliteral">&quot;c2: &quot;</span>, x(2)</div>
<div class="line">    print <span class="stringliteral">&quot;(AF12.8)&quot;</span>, <span class="stringliteral">&quot;c3: &quot;</span>, x(3)</div>
<div class="line">    print <span class="stringliteral">&quot;(AF12.8)&quot;</span>, <span class="stringliteral">&quot;c4: &quot;</span>, x(4)</div>
<div class="line">    print <span class="stringliteral">&quot;(AF9.5)&quot;</span>, <span class="stringliteral">&quot;Max Residual: &quot;</span>, maxval(abs(f))</div>
<div class="line"> </div>
<div class="line"><span class="keyword">contains</span></div>
<div class="line">    <span class="comment">! The function containing the data to fit</span></div>
<div class="line">    <span class="keyword">subroutine </span>fcns(x, f)</div>
<div class="line">        <span class="comment">! Arguments</span></div>
<div class="line"><span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x  <span class="comment">! Contains the coefficients</span></div>
<div class="line"><span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:)</span> :: f</div>
<div class="line"> </div>
<div class="line">        <span class="comment">! Local Variables</span></div>
<div class="line"><span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(21)</span> :: xp, yp</div>
<div class="line"> </div>
<div class="line">        <span class="comment">! Data to fit (21 data points)</span></div>
<div class="line">        xp = [0.0d0, 0.1d0, 0.2d0, 0.3d0, 0.4d0, 0.5d0, 0.6d0, 0.7d0, 0.8d0, &amp;</div>
<div class="line">            0.9d0, 1.0d0, 1.1d0, 1.2d0, 1.3d0, 1.4d0, 1.5d0, 1.6d0, 1.7d0, &amp;</div>
<div class="line">            1.8d0, 1.9d0, 2.0d0]</div>
<div class="line">        yp = [1.216737514d0, 1.250032542d0, 1.305579195d0, 1.040182335d0, &amp;</div>
<div class="line">            1.751867738d0, 1.109716707d0, 2.018141531d0, 1.992418729d0, &amp;</div>
<div class="line">            1.807916923d0, 2.078806005d0, 2.698801324d0, 2.644662712d0, &amp;</div>
<div class="line">            3.412756702d0, 4.406137221d0, 4.567156645d0, 4.999550779d0, &amp;</div>
<div class="line">            5.652854194d0, 6.784320119d0, 8.307936836d0, 8.395126494d0, &amp;</div>
<div class="line">            10.30252404d0]</div>
<div class="line"> </div>
<div class="line">        <span class="comment">! We&#39;ll apply a cubic polynomial model to this data:</span></div>
<div class="line">        <span class="comment">! y = c1 * x**3 + c2 * x**2 + c3 * x + c4</span></div>
<div class="line">        f = x(1) * xp**3 + x(2) * xp**2 + x(3) * xp + x(4) - yp</div>
<div class="line"> </div>
<div class="line">        <span class="comment">! For reference, the data was generated by adding random errors to</span></div>
<div class="line">        <span class="comment">! the following polynomial: y = x**3 - 0.3 * x**2 + 1.2 * x + 0.3</span></div>
<div class="line">    <span class="keyword">end subroutine</span></div>
<div class="line"><span class="keyword">end program</span></div>
</div><!-- fragment --> The above program returns the following results. <div class="fragment"><div class="line">c1:   1.06476276</div>
<div class="line">c2:  -0.12232029</div>
<div class="line">c3:   0.44661345</div>
<div class="line">c4:   1.18661422</div>
<div class="line">Max Residual:   0.50636</div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt>See Also</dt><dd><ul>
<li><a href="https://en.wikipedia.org/wiki/Levenberg%E2%80%93Marquardt_algorithm">Wikipedia</a></li>
<li><a href="https://en.wikipedia.org/wiki/MINPACK">MINPACK (Wikipedia)</a> </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="nonlin__least__squares_8f90_source.html#l00236">236</a> of file <a class="el" href="nonlin__least__squares_8f90_source.html">nonlin_least_squares.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacenonlin__least__squares.html">nonlin_least_squares</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
